<!DOCTYPE html>
<html lang="ko">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9L6DLJ2XKB"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-9L6DLJ2XKB');
    </script>

    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[l]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "v2ogrkuyk0");
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#FF6600">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ê°œí˜2026">
    <link rel="apple-touch-icon" href="https://img.icons8.com/?size=192&id=hfNCM7e9VGca&format=png">

    <meta name="naver-site-verification" content="fd28a70b503cbae1a40202da92ff12c89126a1fe" />

    <title id="dynamic-title">ê°œí˜ì‹ ë‹¹ 2026 ì§€ë°©ì„ ê±° Â· ì¬ë³´ê¶ì„ ê±° ì¶œë§ˆ Â· ê³µì²œ í˜„í™©</title>
    <meta name="description" content="ì œ9íšŒ ì „êµ­ë™ì‹œì§€ë°©ì„ ê±° ê°œí˜ì‹ ë‹¹ í›„ë³´ì ëª…ë‹¨ ì•„ì¹´ì´ë¸Œ">
    <meta property="og:type" content="website">
    <meta property="og:title" content="[ë¹„ê³µì‹] ê°œí˜ì‹ ë‹¹ 2026 ì§€ë°©ì„ ê±° ì¶œë§ˆ Â· ê³µì²œ ì•„ì¹´ì´ë¸Œ" id="meta-og-title">
    <meta property="og:site_name" content="ë¹„ê³µì‹ ì„ ê±° ì•„ì¹´ì´ë¸Œ">
    <meta property="og:description" content="2026 ì§€ì„  í›„ë³´ìë“¤ì„ ì •ë¦¬í•œ í˜ì´ì§€ì…ë‹ˆë‹¤.[ë¹„ê³µì‹]" id="meta-og-description">
    <meta property="og:image" content="https://i.imgur.com/z0Ly5fh.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:url" content="https://restep.cc/">
    <link rel="canonical" href="https://restep.cc/" id="meta-canonical">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://i.imgur.com/z0Ly5fh.png">

    <link rel="icon" href="https://img.icons8.com/?size=100&id=hfNCM7e9VGca&format=png&color=000000" type="image/png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700;800;900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap');
        
        html { scroll-behavior: smooth; transition: background-color 0.3s ease; }
        body {
            font-family: 'Pretendard', 'Noto Sans KR', sans-serif;
            background-color: #f8f9fa;
            color: #1a1a1a;
            letter-spacing: -0.025em;
            word-break: keep-all;
        }

        .dark body {
            background-color: #0f172a;
            color: #f1f5f9;
        }

        #entry-popup-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            z-index: 2000;
            display: flex;
            align-items: center; justify-content: center;
            padding: 20px;
            transition: opacity 0.3s ease-out;
        }

        .nrp-orange { color: #FF6600; }
        .nrp-bg-orange { background-color: #FF6600; }
        .header-gradient {
            background: linear-gradient(to bottom, rgba(255, 102, 0, 0.12) 0%, rgba(255, 102, 0, 0.05) 50%, transparent 100%);
            border-radius: 0 0 3rem 3rem;
        }
        .dark .header-gradient {
            background: linear-gradient(to bottom, rgba(255, 102, 0, 0.2) 0%, rgba(15, 23, 42, 0.5) 50%, #0f172a 100%);
        }

        .nav-container::-webkit-scrollbar { display: none; }
        .nav-container { -ms-overflow-style: none; scrollbar-width: none; }

        @media (min-width: 640px) {
            .card-hover:hover { transform: translateY(-8px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
            .dark .card-hover:hover { box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
        }
        
        .region-tag {
            position: absolute; top: 8px; left: 10px;
            background-color: rgba(255, 102, 0, 0.9);
            color: white; padding: 3px 8px; border-radius: 5px;
            font-size: 0.6rem; font-weight: 700; z-index: 10; backdrop-filter: blur(4px);
        }

        .new-badge {
            display: inline-flex !important;
            align-items: center;
            justify-content: center;
            background-color: #FF6600 !important;
            color: white !important;
            padding: 2px 7px !important;
            border-radius: 6px !important;
            font-size: 0.6rem !important;
            font-weight: 900 !important;
            margin-left: 6px !important;
            vertical-align: middle !important;
            line-height: 1 !important;
            box-shadow: 0 2px 5px rgba(255, 102, 0, 0.4) !important;
            border: 1px solid rgba(255, 255, 255, 0.2);
            height: 18px;
            transform: translateY(-2px);
            text-transform: uppercase;
        }

        .district-tag {
            position: absolute; top: 8px; right: 10px;
            background-color: white; color: #FF6600; border: 1.5px solid #FF6600;
            min-width: 22px; height: 22px; padding: 0 6px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 11px; font-size: 0.65rem; font-weight: 800;
            z-index: 10; box-shadow: 0 2px 4px rgba(0,0,0,0.05); white-space: nowrap;
        }

        .confirmed-badge {
            position: absolute; bottom: 8px; right: 10px;
            background-color: #FF6600; 
            color: white; 
            padding: 3px 8px; 
            border-radius: 8px;
            font-size: 0.7rem; 
            font-weight: 900; 
            z-index: 10;
            box-shadow: 0 4px 10px rgba(255, 102, 0, 0.4);
            letter-spacing: -0.02em;
            display: flex;
            align-items: center;
            gap: 3px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .grid-responsive { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 0.75rem; 
        }
        @media (min-width: 640px) { 
            .grid-responsive { 
                grid-template-columns: repeat(4, 1fr); 
                gap: 1.25rem; 
            } 
        }
        @media (min-width: 1024px) { 
            .grid-responsive { 
                grid-template-columns: repeat(5, 1fr); 
            } 
        }

        .photo-frame { 
            height: 180px; 
            background-color: #f1f3f5; 
            overflow: hidden; 
            position: relative; 
            width: 100%; 
        }
        .dark .photo-frame { background-color: #1e293b; }
        @media (min-width: 640px) { 
            .photo-frame { height: 240px; } 
        }
        
        .candidate-photo { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            display: block; 
            transition: transform 0.3s ease;
        }
        
        .photo-face-focus { object-position: center top !important; }
        
        .section-title {
            display: flex; align-items: center; font-size: 1.2rem; font-weight: 800;
            margin: 2rem 0 0.75rem 0; color: #1a202c;
        }
        .dark .section-title { color: #f1f5f9; }
        @media (min-width: 640px) { .section-title { font-size: 1.6rem; margin: 3rem 0 1.25rem 0; } }
        .section-title::before { content: ""; width: 5px; height: 22px; background-color: #FF6600; margin-right: 10px; border-radius: 2px; }

        .sub-section-title {
            font-size: 1rem; font-weight: 700; color: #4a5568; margin-bottom: 1rem;
            padding-left: 4px; border-left: 3px solid #cbd5e0; margin-left: 2px;
        }
        .dark .sub-section-title { color: #94a3b8; border-left-color: #475569; }

        .bio-text {
            font-size: 0.65rem; color: #718096; margin-bottom: 0.5rem; height: 3.5rem; 
            display: flex; flex-direction: column; justify-content: center;
            font-weight: 600; line-height: 1.3; overflow: hidden;
        }
        .dark .bio-text { color: #94a3b8; }
        @media (min-width: 640px) { .bio-text { font-size: 0.75rem; height: 3.5rem; margin-bottom: 0.75rem; } }

        .nav-btn {
            padding: 0.5rem 0.4rem; border-radius: 0.6rem; font-size: 0.65rem; font-weight: 700;
            color: #4b5563; transition: all 0.2s ease-in-out; cursor: pointer;
        }
        .dark .nav-btn { color: #94a3b8; }
        @media (min-width: 768px) { .nav-btn { font-size: 0.875rem; padding: 0.5rem 1.25rem; } }
        .nav-btn:hover:not(:disabled) { background-color: #fff7ed; color: #FF6600; }
        .dark .nav-btn:hover:not(:disabled) { background-color: #1e293b; color: #fb923c; }
        .nav-btn.active { background-color: #FF6600; color: white; }
        .dark .nav-btn.active { background-color: #FF6600; color: white; }
        .nav-btn:disabled { color: #d1d5db; cursor: default; }

        .map-path { transition: fill 0.2s ease-out, stroke 0.2s ease-out, opacity 0.3s ease-in-out; outline: none; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .animate-spin-custom { animation: spin 1s linear infinite; }
        
        .no-photo-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            color: #cbd5e1;
            font-weight: 700;
            font-size: 0.75rem;
            gap: 8px;
        }
        .dark .no-photo-placeholder { background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); color: #475569; }
        .no-photo-placeholder svg {
            width: 48px;
            height: 48px;
            opacity: 0.5;
        }

        #profile-modal-overlay {
            display: none; position: fixed; inset: 0; background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px); z-index: 1000; align-items: center; justify-content: center;
            padding: 20px;
        }
        .modal-content {
            background: white; width: 100%; max-width: 400px; border-radius: 1.5rem;
            overflow: hidden; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5);
            animation: modalFadeIn 0.3s ease-out; position: relative;
        }
        .dark .modal-content { background-color: #1e293b; color: #f1f5f9; }
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        #profile-modal-overlay.active { display: flex; }

        /* ëª¨ë‹¬ ìš°ìƒë‹¨ ê³µìœ  ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .modal-share-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(4px);
            padding: 6px 14px;
            border-radius: 99px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            cursor: pointer;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.2s;
            z-index: 20;
            color: #FF6600;
            font-size: 0.75rem;
            font-weight: 800;
            border: 1px solid rgba(255, 102, 0, 0.1);
        }
        .dark .modal-share-btn {
            background-color: rgba(30, 41, 59, 0.95);
            color: #FF6600;
            border-color: rgba(255, 102, 0, 0.3);
        }
        .modal-share-btn:hover {
            transform: translateY(-2px);
            background-color: #fff7ed;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .dark .modal-share-btn:hover {
            background-color: #1e293b;
        }

        .sns-btn {
            width: 44px; height: 44px; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            background: #f1f3f5; color: #495057; transition: all 0.2s;
        }
        .dark .sns-btn { background: #334155; color: #cbd5e1; }
        .sns-btn:hover { background: #e9ecef; transform: translateY(-2px); }
        .dark .sns-btn:hover { background: #475569; }
        .sns-btn.fb:hover { color: #1877F2; }
        .sns-btn.ig:hover { color: #E4405F; }
        .sns-btn.youtube:hover { color: #FF0000; }
        .sns-btn.blog:hover { color: #03C75A; }
        .sns-btn.threads:hover { color: #000000; }
        .sns-btn.site:hover { color: #FF6600; }

        .region-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.4rem;
        }
        @media (min-width: 640px) {
            .region-grid { grid-template-columns: repeat(6, 1fr); gap: 0.5rem; }
        }
        @media (min-width: 1024px) {
            .region-grid { grid-template-columns: repeat(8, 1fr); }
        }
        .region-box {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.08);
            padding: 0.4rem 0.25rem;
            border-radius: 0.75rem;
            text-align: center;
            transition: all 0.2s;
        }
        .dark .region-box { background: rgba(30, 41, 59, 0.5); border-color: rgba(255, 255, 255, 0.05); }
        .region-box:hover { background: rgba(255, 255, 255, 1); border-color: #FF6600; }
        .dark .region-box:hover { background: rgba(51, 65, 85, 1); border-color: #FF6600; }
        .visitor-badge-area { display: flex; align-items: center; justify-content: center; opacity: 0.8; }
        @media (min-width: 768px) { .visitor-badge-area { justify-content: flex-end; margin-top: 0; } }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 20px; }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb { background: #334155; }
        
        /* ì§€ë„ìš© ìŠ¤íƒ€ì¼ */
        .cursor-grab { cursor: grab; }
        .cursor-grabbing { cursor: grabbing; }

        .collapsible-container {
            transition: all 0.5s ease-in-out;
            overflow: hidden;
        }

        .dark-mode-toggle {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 16px;
            border-radius: 99px;
            font-size: 12px;
            font-weight: 800;
            transition: all 0.2s;
            background-color: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
        }
        .dark .dark-mode-toggle {
            background-color: #1e293b;
            color: #f1f5f9;
            border-color: #334155;
        }

        .share-btn-item {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background-color: #f3f4f6;
            color: #4b5563;
            transition: all 0.2s;
            border: 1px solid #e5e7eb;
        }
        .dark .share-btn-item {
            background-color: #1e293b;
            color: #cbd5e1;
            border-color: #334155;
        }
        .share-btn-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .share-btn-item.facebook:hover { background-color: #1877F2; color: white; border-color: #1877F2; }
        .share-btn-item.x:hover { background-color: #000000; color: white; border-color: #000000; }
        .dark .share-btn-item.x:hover { background-color: #fff; color: black; border-color: #fff; }
        .share-btn-item.link:hover { background-color: #FF6600; color: white; border-color: #FF6600; }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        .share-fallback-animate {
            animation: fadeInScale 0.2s ease-out forwards;
        }

        /* PWA ì„¤ì¹˜ ë²„íŠ¼ ì¶”ê°€ ìŠ¤íƒ€ì¼ */
        #pwa-install-btn {
            display: none; /* ê¸°ë³¸ ìˆ¨ê¹€ */
        }
    </style>
</head>
<body id="top" class="p-0 overflow-hidden">
    <div id="entry-popup-overlay">
        <div class="bg-white dark:bg-slate-800 rounded-[2rem] p-8 md:p-12 max-w-md w-full text-center shadow-2xl border border-gray-100 dark:border-slate-700 scale-95 md:scale-100 transition-transform">
            <div class="mb-6 flex justify-center text-[#FF6600]">
                <i data-lucide="alert-circle" class="w-12 h-12"></i>
            </div>
            <h2 class="text-xl md:text-2xl font-black mb-4 tracking-tight leading-snug dark:text-white">
                ì´ í™ˆí˜ì´ì§€ëŠ” ê°œí˜ì‹ ë‹¹ì˜<br>ê³µì‹ í™ˆí˜ì´ì§€ê°€ ì•„ë‹™ë‹ˆë‹¤.
            </h2>
            <p class="text-gray-500 dark:text-slate-400 font-semibold mb-8 text-sm md:text-base leading-relaxed">
                ì¶œë§ˆ ì„ ì–¸ ë° ê³µì²œ í™•ì •ì¸ í›„ë³´ë“¤ë§Œ ì •ë¦¬í•œ<br>ë¹„ê³µì‹ ì •ë³´ ì‚¬ì´íŠ¸ ì…ë‹ˆë‹¤.
            </p>
            <button onclick="closeEntryPopup()" 
                class="w-full py-4 md:py-5 nrp-bg-orange text-white rounded-2xl font-black text-lg md:text-xl shadow-lg hover:shadow-orange-200 transition-all transform hover:-translate-y-1 active:scale-95">
                ì´í•´í–ˆìœ¼ë©´ ì…ì¥í•˜ê¸°
            </button>
        </div>
    </div>

    <header class="header-gradient pt-8 pb-2 px-4 md:pt-12 md:pb-3 md:px-10 mb-0">
        <div class="max-w-7xl mx-auto">
            <div class="flex justify-between items-center mb-10">
                <div class="bg-white dark:bg-slate-900 border-2 border-[#FF6600] px-4 py-1.5 md:px-8 md:py-3 rounded-full shadow-sm">
                    <span id="last-update-date" class="nrp-orange font-black text-xs md:text-xl tracking-tighter whitespace-nowrap">
                        ìµœì¢… ì—…ë°ì´íŠ¸ : 2026. 02. 15
                    </span>
                </div>
                <div id="d-day-badge" class="nrp-bg-orange text-white px-4 py-1.5 md:px-8 md:py-3 rounded-full text-sm md:text-2xl font-black tracking-tighter shadow-lg whitespace-nowrap">
                    D-000
                </div>
            </div>
            <div class="text-center">
                <h1 class="text-2xl md:text-5xl font-black mb-4 tracking-tighter text-gray-900 dark:text-white leading-tight md:leading-[1.1]">
                    <span class="block mb-2 md:mb-4">
                        <span class="tracking-[-0.12em]">6 Â· 3</span> ì§€ë°©ì„ ê±° Â· ì¬ë³´ê¶ì„ ê±°
                    </span>
                    <span class="block">ì¶œë§ˆ Â· ê³µì²œ í˜„í™©</span>
                </h1>
                <p class="text-gray-500 dark:text-slate-400 text-sm md:text-lg font-semibold mb-6 text-center">ì œ9íšŒ ì „êµ­ë™ì‹œì§€ë°©ì„ ê±°ë¥¼ í–¥í•œ ê°œí˜ì˜ ë„ì „</p>
                <div class="text-center">
                    <a href="https://apply.reformparty.kr/" target="_blank" 
                       class="inline-block bg-white dark:bg-slate-900 border-2 border-[#FF6600] nrp-orange px-8 py-3 md:px-14 md:py-4 rounded-2xl text-sm md:text-xl font-black hover:bg-[#FF6600] hover:text-white transition-all duration-300 shadow-md hover:shadow-xl transform hover:-translate-y-1">
                          ê°œí˜ì‹ ë‹¹ ì˜¨ë¼ì¸ ê³µì²œì‹¬ì‚¬ ì‹œìŠ¤í…œ ë“¤ì–´ê°€ê¸°
                    </a>
                    
                    <div class="mt-8 space-y-4">
                        <div class="max-w-2xl mx-auto bg-white dark:bg-slate-800 border border-orange-200 dark:border-orange-900/50 rounded-[2rem] p-6 md:p-8 shadow-sm">
                            <div class="flex items-center justify-center gap-2 mb-4">
                                <i data-lucide="alert-triangle" class="w-5 h-5 md:w-6 md:h-6 text-[#FF6600]"></i>
                                <span class="text-[#FF6600] text-lg md:text-2xl font-black tracking-tight">ì£¼ì˜ì‚¬í•­</span>
                            </div>
                            <div class="inline-block text-left space-y-2 text-gray-700 dark:text-slate-300 text-xs md:text-sm font-bold">
                                <p class="flex items-start gap-1.5">
                                    <span class="mt-1.5 flex-shrink-0 w-1 h-1 rounded-full bg-[#FF6600]"></span>
                                    <span>ì´ í˜ì´ì§€ëŠ” <strong class="underline font-black text-gray-900 dark:text-white">ê°œí˜ì‹ ë‹¹ê³¼ ê´€ë ¨ ì—†ëŠ” ë¹„ê³µì‹ í˜ì´ì§€</strong>ì…ë‹ˆë‹¤.</span>
                                </p>
                                <p class="flex items-start gap-1.5">
                                    <span class="mt-1.5 flex-shrink-0 w-1 h-1 rounded-full bg-[#FF6600]"></span>
                                    <span>'ê³µê°œ ì¶œë§ˆ ì„ ì–¸' í˜¹ì€ 'í›„ë³´ì ì§ì ‘ ì œë³´'ë¥¼ ì •ë¦¬í•œ ëª…ë‹¨ì…ë‹ˆë‹¤.</span>
                                </p>
                                <p class="flex items-start gap-1.5">
                                    <span class="mt-1.5 flex-shrink-0 w-1 h-1 rounded-full bg-[#FF6600]"></span>
                                    <span>í•´ë‹¹ ì •ë³´ëŠ” ìƒì‹œ ë³€ê²½ë  ìˆ˜ ìˆìœ¼ë©°, ìˆ˜ë™ ìˆ˜ì§‘ìœ¼ë¡œ ë¶€ì •í™•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
                                </p>
                            </div>
                        </div>

                        <div class="max-w-2xl mx-auto bg-gray-50 dark:bg-slate-800/50 border border-gray-100 dark:border-slate-700 rounded-[2rem] shadow-sm overflow-hidden transition-all">
                            <div onclick="toggleNoticeVisibility()" class="p-6 md:p-8 flex flex-col items-center justify-center cursor-pointer hover:bg-gray-100 dark:hover:bg-slate-700/50 transition-colors group">
                                <div class="flex items-center justify-center gap-2 mb-2">
                                    <i data-lucide="info" class="w-5 h-5 md:w-5 md:h-5 text-gray-400 group-hover:text-[#FF6600] transition-colors"></i>
                                    <span class="text-gray-800 dark:text-slate-200 text-sm md:text-xl font-black tracking-tight">ê³µì²œ ì‹¬ì‚¬ Â· ë°œí‘œ ê´€ë ¨ ì°¸ê³ ì‚¬í•­</span>
                                </div>
                                <div class="flex items-center gap-1.5 text-[10px] md:text-xs font-bold text-gray-400">
                                    <span>[í¼ì¹˜ê¸° Â· ë‹«ê¸°]</span>
                                    <div id="notice-toggle-icon-wrapper" class="transition-transform duration-300">
                                        <i data-lucide="chevron-down" class="w-4 h-4"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="notice-collapsible-content" class="hidden opacity-0 h-0 collapsible-container px-6 pb-8 md:px-8 md:pb-10">
                                <div class="flex flex-col gap-2.5 items-center">
                                    <p class="text-gray-700 dark:text-slate-300 bg-white dark:bg-slate-900 border border-orange-100 dark:border-orange-900/30 rounded-xl py-2.5 px-4 w-full max-w-lg text-center text-[10px] md:text-sm font-bold shadow-sm">
                                        <span class="text-[#FF6600]">ì œ4ì°¨ ê³µì²œê²°ê³¼ : 9ëª…</span> (02.12.) | 
                                        <a href="https://rallypoint.kr/board/notice/225748" target="_blank" class="underline hover:text-gray-900 dark:hover:text-white transition-colors font-black ml-1">ê³µê³ ë³´ê¸°</a>
                                    </p>
                                    <p class="text-gray-700 dark:text-slate-300 bg-white dark:bg-slate-900 border border-orange-100 dark:border-orange-900/30 rounded-xl py-2.5 px-4 w-full max-w-lg text-center text-[10px] md:text-sm font-bold shadow-sm">
                                        <span class="text-[#FF6600]">ì œ3ì°¨ ê³µì²œê²°ê³¼ : 17ëª…</span> (02.09.) | 
                                        <a href="https://rallypoint.kr/board/notice/225533" target="_blank" class="underline hover:text-gray-900 dark:hover:text-white transition-colors font-black ml-1">ê³µê³ ë³´ê¸°</a>
                                    </p>
                                    <p class="text-gray-700 dark:text-slate-300 bg-white dark:bg-slate-900 border border-orange-100 dark:border-orange-900/30 rounded-xl py-2.5 px-4 w-full max-w-lg text-center text-[10px] md:text-sm font-bold shadow-sm">
                                        <span class="text-[#FF6600]">ì œ2ì°¨ ê³µì²œê²°ê³¼ : 18ëª…</span> (02.05.) | 
                                        <a href="https://rallypoint.kr/board/notice/225284" target="_blank" class="underline hover:text-gray-900 dark:hover:text-white transition-colors font-black ml-1">ê³µê³ ë³´ê¸°</a>
                                    </p>
                                    <p class="text-gray-700 dark:text-slate-300 bg-white dark:bg-slate-900 border border-orange-100 dark:border-orange-900/30 rounded-xl py-2.5 px-4 w-full max-w-lg text-center text-[10px] md:text-sm font-bold shadow-sm">
                                        <span class="text-[#FF6600]">ì œ1ì°¨ ê³µì²œê²°ê³¼ : 29ëª…</span> (01.26.) | 
                                        <a href="https://rallypoint.kr/board/notice/224559" target="_blank" class="underline hover:text-gray-900 dark:hover:text-white transition-colors font-black ml-1">ê³µê³ ë³´ê¸°</a>
                                    </p>
                                    <p class="text-gray-700 dark:text-slate-300 bg-white dark:bg-slate-900 border border-gray-100 dark:border-slate-800 rounded-xl py-2.5 px-4 w-full max-w-lg text-center text-[10px] md:text-sm font-bold shadow-sm">
                                        'ì´ë¯¸ ìˆ˜ë°±ëª…ì˜ í›„ë³´ìë“¤ì´ ìˆë‹¤' : ì´ì¤€ì„ ëŒ€í‘œ (01.13.) | 
                                        <a href="https://www.youtube.com/live/9HRqgZ0Lghw?si=268vprQF1QLCHBoc&t=2065" target="_blank" class="underline hover:text-gray-900 dark:hover:text-white transition-colors font-black ml-1">ì˜ìƒë³´ê¸°</a>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 md:px-10 mt-2 mb-4">
        <div class="flex flex-row items-center justify-center gap-3">
             <button id="pwa-install-btn" class="inline-flex items-center gap-2 px-5 py-2.5 bg-orange-600 text-white border border-orange-500 rounded-xl font-black text-sm shadow-md hover:bg-orange-700 transition-all active:scale-95">
                <i data-lucide="smartphone" class="w-4 h-4"></i> ì•± ì„¤ì¹˜í•˜ê¸°
             </button>

             <button onclick="sharePage()" class="inline-flex items-center gap-2 px-5 py-2.5 bg-white dark:bg-slate-800 border border-orange-200 dark:border-orange-900/50 rounded-xl text-orange-600 dark:text-orange-400 font-black text-sm shadow-sm hover:shadow-md hover:-translate-y-0.5 transition-all active:scale-95">
                <i data-lucide="share-2" class="w-4 h-4"></i> ì´ í˜ì´ì§€ ê³µìœ í•˜ê¸°
             </button>
        </div>
        
        <div id="share-fallback-area" class="hidden items-center justify-center gap-3 mt-4 share-fallback-animate">
           <button onclick="shareToSNS('facebook')" class="share-btn-item facebook" aria-label="í˜ì´ìŠ¤ë¶ ê³µìœ ">
               <i data-lucide="facebook" class="w-5 h-5"></i>
           </button>
           <button onclick="shareToSNS('x')" class="share-btn-item x" aria-label="X(íŠ¸ìœ„í„°) ê³µìœ ">
               <i data-lucide="twitter" class="w-5 h-5"></i>
           </button>
           <button onclick="copyLink()" class="share-btn-item link" aria-label="ë§í¬ ë³µì‚¬">
               <i data-lucide="link" class="w-5 h-5"></i>
           </button>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-4 md:px-10 mt-6 mb-4 block">
        <div onclick="toggleMapVisibility()" class="flex justify-between items-center bg-white dark:bg-slate-800 border border-orange-100 dark:border-slate-700 rounded-2xl p-5 mb-3 shadow-sm cursor-pointer hover:bg-orange-50 dark:hover:bg-slate-700/50 transition-all group">
            <div class="flex items-center gap-3">
                <div class="bg-orange-100 dark:bg-orange-900/30 p-2 rounded-xl group-hover:bg-[#FF6600] transition-colors">
                    <i data-lucide="map" class="w-5 h-5 text-[#FF6600] group-hover:text-white transition-colors"></i>
                </div>
                <span class="font-black text-gray-800 dark:text-slate-100 text-lg">ì„œìš¸ ê¸°ì´ˆì˜íšŒ ì„ ê±°êµ¬ ì§€ë„ (beta)<span id="seoul-map-new-badge" class="new-badge">NEW</span></span>
            </div>
            <div class="flex items-center gap-2 text-sm font-bold text-gray-400">
                <span id="map-toggle-label">[í¼ì¹˜ê¸° Â· ë‹«ê¸°]</span>
                <div id="map-toggle-icon-wrapper" class="transition-transform duration-300">
                    <i data-lucide="chevron-down" class="w-5 h-5 text-gray-400"></i>
                </div>
            </div>
        </div>
        
        <div id="map-collapsible-content" class="hidden opacity-0 h-0 collapsible-container">
            <div id="map-dashboard-root"></div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-4 md:px-10 mt-4 mb-8 block">
        <div onclick="toggleGyeonggiMapVisibility()" class="flex justify-between items-center bg-white dark:bg-slate-800 border border-orange-100 dark:border-slate-700 rounded-2xl p-5 mb-3 shadow-sm cursor-pointer hover:bg-orange-50 dark:hover:bg-slate-700/50 transition-all group">
            <div class="flex items-center gap-3">
                <div class="bg-orange-100 dark:bg-orange-900/30 p-2 rounded-xl group-hover:bg-[#FF6600] transition-colors">
                    <i data-lucide="map-pinned" class="w-5 h-5 text-[#FF6600] group-hover:text-white transition-colors"></i>
                </div>
                <span class="font-black text-gray-800 dark:text-slate-100 text-lg">ê²½ê¸° ê¸°ì´ˆì˜íšŒ ì„ ê±°êµ¬ ì§€ë„ (beta)<span id="gyeonggi-map-new-badge" class="new-badge">NEW</span></span>
            </div>
            <div class="flex center gap-2 text-sm font-bold text-gray-400">
                <span id="gyeonggi-map-toggle-label">[í¼ì¹˜ê¸° Â· ë‹«ê¸°]</span>
                <div id="gyeonggi-map-toggle-icon-wrapper" class="transition-transform duration-300">
                    <i data-lucide="chevron-down" class="w-5 h-5 text-gray-400"></i>
                </div>
            </div>
        </div>
        
        <div id="gyeonggi-map-dashboard-root-content" class="hidden opacity-0 h-0 collapsible-container">
            <div id="gyeonggi-map-dashboard-root-render"></div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-4 md:px-10">
        <nav class="sticky top-4 z-50 mb-6 flex justify-center mt-2">
            <div class="nav-container flex items-center bg-white/90 dark:bg-slate-800/90 backdrop-blur-md shadow-lg border border-gray-100 dark:border-slate-700 rounded-2xl p-1 md:p-1.5 overflow-x-auto whitespace-nowrap gap-0">
                <button onclick="scrollToId('top')" class="nav-btn" id="btn-original">í™ˆ</button>
                <div class="w-px h-4 bg-gray-200 dark:bg-slate-700 mx-0.5 flex-shrink-0"></div>
                <button onclick="scrollToId('provincial-exec')" class="nav-btn">ê´‘ì—­ë‹¨ì²´ì¥</button>
                <button onclick="scrollToId('local-exec')" class="nav-btn">ê¸°ì´ˆë‹¨ì²´ì¥</button>
                <button onclick="scrollToId('provincial-council')" class="nav-btn">ê´‘ì—­ì˜ì›</button>
                <button onclick="scrollToId('local-council')" class="nav-btn">ê¸°ì´ˆì˜ì›</button>
                <button onclick="scrollToId('by-election')" class="nav-btn" id="nav-by-election">ì¬ë³´ê¶ì„ ê±°</button>
                <div class="w-px h-4 bg-gray-200 dark:bg-slate-700 mx-0.5 flex-shrink-0"></div>
                <button onclick="renderRegionView()" class="nav-btn" id="btn-region">ì§€ì—­ë³„ë³´ê¸°</button>
            </div>
        </nav>

        <main id="content-area"></main>

        <footer id="summary" class="mt-16 bg-gray-900 dark:bg-slate-900 text-white rounded-[1.5rem] md:rounded-[2.5rem] p-6 md:p-10 shadow-2xl border-b-8 border-orange-500">
            <div class="flex flex-col gap-8 w-full">
                <div class="flex flex-col lg:flex-row justify-between items-center gap-6">
                    <div class="text-center lg:text-left">
                        <h2 class="text-xl md:text-3xl font-black mb-1">ì¶œë§ˆ Â· ê³µì²œ í˜„í™©</h2>
                        <p class="text-gray-400 text-[10px] md:text-sm font-medium">ì „ì²´ í›„ë³´ì ìš”ì•½ í†µê³„</p>
                    </div>
                    <div class="grid grid-cols-6 gap-2 md:gap-8 w-full lg:w-auto text-center items-center">
                        <div><p class="text-gray-500 text-[8px] md:text-xs font-bold uppercase mb-0.5">ì¬ë³´ê¶</p><p class="text-lg md:text-2xl font-black nrp-orange" id="sum-by">0</p></div>
                        <div><p class="text-gray-500 text-[7px] md:text-xs font-bold uppercase mb-0.5">ê´‘ì—­ë‹¨ì²´</p><p class="text-lg md:text-2xl font-black nrp-orange" id="sum-prov-exec">0</p></div>
                        <div><p class="text-gray-500 text-[7px] md:text-xs font-bold uppercase mb-0.5">ê¸°ì´ˆë‹¨ì²´</p><p class="text-lg md:text-2xl font-black nrp-orange" id="sum-local-exec">0</p></div>
                        <div><p class="text-gray-500 text-[7px] md:text-xs font-bold uppercase mb-0.5">ê´‘ì—­ì˜íšŒ</p><p class="text-lg md:text-2xl font-black nrp-orange" id="sum-prov-council">0</p></div>
                        <div><p class="text-gray-500 text-[7px] md:text-xs font-bold uppercase mb-0.5">ê¸°ì´ˆì˜íšŒ</p><p class="text-lg md:text-2xl font-black nrp-orange" id="sum-local-council">0</p></div>
                        <div class="lg:border-l border-gray-700 lg:pl-10"><p class="text-gray-500 text-[8px] md:text-xs font-bold uppercase mb-0.5">Total</p><p class="text-lg md:text-2xl font-black text-white" id="sum-total">0</p></div>
                    </div>
                </div>
                <div class="border-t border-gray-800 pt-6">
                    <div class="text-center lg:text-left w-full mb-4">
                        <h2 class="text-lg md:text-2xl font-black mb-1">ì§€ì—­ë³„ í˜„í™©</h2>
                        <p class="text-gray-500 text-[10px] md:text-xs font-medium">ì „êµ­ ê´‘ì—­ ë‹¨ì²´ë³„ í›„ë³´ì ë¶„í¬</p>
                    </div>
                    <div class="region-grid" id="region-status-grid"></div>
                </div>
            </div>
        </footer>

        <div class="mt-12 mb-16 flex flex-col md:flex-row justify-between items-center gap-8 border-t border-gray-200 dark:border-slate-800 pt-8 pb-8 text-gray-400 dark:text-slate-500">
            <div class="flex flex-col items-center md:items-start gap-4">
                <p class="text-[10px] md:text-xs font-medium leading-relaxed text-center md:text-left">
                    ì´ í˜ì´ì§€ëŠ” <strong class="text-gray-500 dark:text-slate-400 font-bold">ê°œí˜ì‹ ë‹¹ê³¼ ê´€ë ¨ ì—†ëŠ” ë¹„ê³µì‹ í˜ì´ì§€</strong>ì…ë‹ˆë‹¤.<br>
                    ë‚´ìš© ì¶”ê°€, ì˜¤ë¥˜ ìˆ˜ì •, ì •ë³´ ì œê±°ë¥¼ ì›í•˜ì‹œë©´ <a href="https://rallypoint.kr" target="_blank" class="underline hover:text-gray-600 dark:hover:text-slate-300 transition-colors">ë‹¹ì›ê²Œì‹œíŒ</a>ìœ¼ë¡œ ë¬¸ì˜ì£¼ì„¸ìš”. (ë‹‰ë„¤ì„: ì´ì¦Œì„)
                </p>
                <button onclick="toggleDarkMode()" class="dark-mode-toggle shadow-sm hover:shadow-md active:scale-95 transition-all">
                    <span id="dark-mode-icon-wrapper"><i data-lucide="moon" class="w-3 h-3"></i></span>
                    <span id="dark-mode-text">ë‹¤í¬ëª¨ë“œë¡œ ë³´ê¸°</span>
                </button>
            </div>
            <div class="visitor-badge-area shrink-0">
                <a href="https://myhits.vercel.app" target="_blank">
                    <img src="https://myhits.vercel.app/api/hit/https%3A%2F%2Frestep.cc%2F?color=gray&label=HITS%F0%9F%A7%A1&size=small" alt="HITSğŸ§¡" />
                </a>
            </div>
        </div>
    </div>

    <div id="profile-modal-overlay" onclick="closeProfileModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-share-btn" onclick="shareCurrentCandidate(event)">
                <i data-lucide="share-2" class="w-4 h-4"></i>
                <span>ê³µìœ í•˜ê¸°</span>
            </div>
            
            <div class="relative h-72 bg-gray-100 dark:bg-slate-700 overflow-hidden" id="modal-photo-area"></div>
            <div class="p-8 text-center">
                <h2 class="text-2xl font-black mb-1 tracking-wider" id="modal-name">í›„ë³´ ì´ë¦„</h2>
                <p class="text-[#FF6600] font-bold text-sm mb-1 leading-tight" id="modal-office">ì¶œë§ˆì„ ì–¸</p>
                <p class="text-gray-400 dark:text-slate-400 font-medium text-[11px] mb-6" id="modal-subregion"></p>
                <div class="flex justify-center gap-4 mb-8" id="modal-sns-container">
                    <a id="modal-fb" href="#" target="_blank" class="sns-btn fb"><i data-lucide="facebook"></i></a>
                    <a id="modal-ig" href="#" target="_blank" class="sns-btn ig"><i data-lucide="instagram"></i></a>
                    <a id="modal-threads" href="#" target="_blank" class="sns-btn threads"><i data-lucide="at-sign"></i></a>
                    <a id="modal-yt" href="#" target="_blank" class="sns-btn youtube"><i data-lucide="youtube"></i></a>
                    <a id="modal-blog" href="#" target="_blank" class="sns-btn blog"><i data-lucide="link-2"></i></a>
                    <a id="modal-site" href="#" target="_blank" class="sns-btn site"><i data-lucide="globe"></i></a>
                </div>
                <a id="modal-declaration" href="#" target="_blank" class="block w-full py-4 nrp-bg-orange text-white rounded-2xl font-black text-lg shadow-lg hover:shadow-orange-200 transition-all">ì¶œë§ˆì„ ì–¸ ë³´ê¸°</a>
                <button onclick="closeProfileModal()" class="mt-6 text-gray-400 dark:text-slate-500 text-sm font-bold hover:text-gray-600 dark:hover:text-slate-300 tracking-tight">ì°½ ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <script>
        let currentModalCandidateName = '';

        /* ë‹¤í¬ëª¨ë“œ ê´€ë¦¬ */
        function initDarkMode() {
            const isDark = localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
            if (isDark) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
            updateDarkModeUI(isDark);
        }

        window.toggleDarkMode = function() {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            updateDarkModeUI(isDark);
        };

        function updateDarkModeUI(isDark) {
            const text = document.getElementById('dark-mode-text');
            const iconWrapper = document.getElementById('dark-mode-icon-wrapper');
            if (text && iconWrapper) {
                text.innerText = isDark ? 'ë¼ì´íŠ¸ëª¨ë“œë¡œ ë³´ê¸°' : 'ë‹¤í¬ëª¨ë“œë¡œ ë³´ê¸°';
                iconWrapper.innerHTML = isDark ? '<i data-lucide="sun" class="w-3 h-3 text-orange-400"></i>' : '<i data-lucide="moon" class="w-3 h-3 text-slate-500"></i>';
                lucide.createIcons();
            }
        }

        window.closeEntryPopup = function() {
            const overlay = document.getElementById('entry-popup-overlay');
            if (overlay) {
                overlay.style.opacity = '0';
                setTimeout(() => {
                    overlay.style.display = 'none';
                    document.body.classList.remove('overflow-hidden');
                }, 300);
            }
        };

        window.toggleNoticeVisibility = function() {
            const content = document.getElementById('notice-collapsible-content');
            const iconWrapper = document.getElementById('notice-toggle-icon-wrapper');
            const isHidden = content.classList.contains('hidden');

            if (isHidden) {
                content.classList.remove('hidden');
                setTimeout(() => {
                    content.style.height = 'auto';
                    const fullHeight = content.scrollHeight + 'px';
                    content.style.height = '0';
                    setTimeout(() => {
                        content.style.height = fullHeight;
                        content.style.opacity = '1';
                        iconWrapper.style.transform = 'rotate(180deg)';
                    }, 10);
                }, 10);
            } else {
                content.style.height = '0';
                content.style.opacity = '0';
                iconWrapper.style.transform = 'rotate(0deg)';
                setTimeout(() => {
                    content.classList.add('hidden');
                }, 500);
            }
        };

        window.toggleMapVisibility = function() {
            const content = document.getElementById('map-collapsible-content');
            const iconWrapper = document.getElementById('map-toggle-icon-wrapper');
            const isHidden = content.classList.contains('hidden');

            if (isHidden) {
                content.classList.remove('hidden');
                setTimeout(() => {
                    const isMobile = window.innerWidth < 1024;
                    content.style.height = isMobile ? '900px' : '550px';
                    content.style.opacity = '1';
                    iconWrapper.style.transform = 'rotate(180deg)';
                }, 10);
            } else {
                content.style.height = '0';
                content.style.opacity = '0';
                iconWrapper.style.transform = 'rotate(0deg)';
                setTimeout(() => {
                    content.classList.add('hidden');
                }, 500);
            }
        };

        window.toggleGyeonggiMapVisibility = function() {
            const content = document.getElementById('gyeonggi-map-dashboard-root-content');
            const iconWrapper = document.getElementById('gyeonggi-map-toggle-icon-wrapper');
            const isHidden = content.classList.contains('hidden');

            if (isHidden) {
                content.classList.remove('hidden');
                setTimeout(() => {
                    const isMobile = window.innerWidth < 1024;
                    content.style.height = isMobile ? '950px' : '650px'; 
                    content.style.opacity = '1';
                    iconWrapper.style.transform = 'rotate(0deg)';
                }, 10);
            } else {
                content.style.height = '0';
                content.style.opacity = '0';
                iconWrapper.style.transform = 'rotate(0deg)';
                setTimeout(() => {
                    content.classList.add('hidden');
                }, 500);
            }
        };

        /* SEOìš© ë©”íƒ€ë°ì´í„° ë™ì  ì—…ë°ì´íŠ¸ í•¨ìˆ˜ */
        function updateMetadata(name, title, description) {
            // ë¸Œë¼ìš°ì € íƒ­ íƒ€ì´í‹€ ë³€ê²½
            document.title = name ? `[ê°œí˜ì‹ ë‹¹] ${name} í›„ë³´ í”„ë¡œí•„ | 2026 ì§€ë°©ì„ ê±°` : "ê°œí˜ì‹ ë‹¹ 2026 ì§€ë°©ì„ ê±° ì•„ì¹´ì´ë¸Œ";
            
            // OG íƒœê·¸ ì—…ë°ì´íŠ¸
            const ogTitle = document.getElementById('meta-og-title');
            const ogDesc = document.getElementById('meta-og-description');
            const canonical = document.getElementById('meta-canonical');
            const currentUrl = name ? `${window.location.origin}${window.location.pathname}?candidate=${encodeURIComponent(name)}` : window.location.origin + window.location.pathname;

            if (ogTitle) ogTitle.setAttribute('content', name ? `ê°œí˜ì‹ ë‹¹ ${name} í›„ë³´ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”!` : "[ë¹„ê³µì‹] ê°œí˜ì‹ ë‹¹ 2026 ì§€ë°©ì„ ê±° ì¶œë§ˆ Â· ê³µì²œ ì•„ì¹´ì´ë¸Œ");
            if (ogDesc) ogDesc.setAttribute('content', description || "2026 ì§€ì„  í›„ë³´ìë“¤ì„ ì •ë¦¬í•œ í˜ì´ì§€ì…ë‹ˆë‹¤.[ë¹„ê³µì‹]");
            if (canonical) canonical.setAttribute('href', currentUrl);
            
            // URL íˆìŠ¤í† ë¦¬ ì—…ë°ì´íŠ¸ (ìƒˆë¡œê³ ì¹¨ ì—†ì´ ì£¼ì†Œì°½ ë³€ê²½)
            if (window.history.pushState) {
                window.history.pushState(null, null, currentUrl);
            }
        }

        /* ê³µìœ í•˜ê¸° ê´€ë ¨ í•¨ìˆ˜ */
        window.sharePage = function() {
            if (navigator.share) {
                navigator.share({
                    title: 'ê°œí˜ì‹ ë‹¹ 2026 ì§€ë°©ì„ ê±° í˜„í™©',
                    text: 'ê°œí˜ì‹ ë‹¹ 2026 ì§€ë°©ì„ ê±° ì¶œë§ˆÂ·ê³µì²œ í˜„í™© ì•„ì¹´ì´ë¸Œì…ë‹ˆë‹¤.',
                    url: window.location.href,
                }).catch(console.error);
            } else {
                const area = document.getElementById('share-fallback-area');
                if (area.classList.contains('hidden')) {
                    area.classList.remove('hidden');
                    area.classList.add('flex');
                } else {
                    area.classList.add('hidden');
                    area.classList.remove('flex');
                }
            }
        };

        window.shareCurrentCandidate = function(e) {
            e.stopPropagation();
            const name = currentModalCandidateName;
            if(!name) return;
            
            const c = candidates.find(cand => cand.name === name);
            if (!c) return;

            const isConfirmed = (c.status === "í›„ë³´" && c.name !== "ê¹€ì„±ë¯¼" && c.name !== "ì´ìˆ˜ì°¬" && c.name !== "ë°•ì¢…ê¸¸");
            const roleLabel = isConfirmed ? "ì˜ˆë¹„í›„ë³´" : "ì¶œë§ˆì";

            let shareTextContent = "";
            
            if (c.category === "ê´‘ì—­ë‹¨ì²´ì¥") {
                shareTextContent = `[ê°œí˜ì‹ ë‹¹] ${c.office} ${roleLabel} ${name} ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”!`;
            } else if (c.category === "ê¸°ì´ˆë‹¨ì²´ì¥") {
                shareTextContent = `[ê°œí˜ì‹ ë‹¹] ${c.office} ${roleLabel} ${name} ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”!`;
            } else if (c.category === "ê´‘ì—­ì˜ì›") {
                if (c.constituency === "ë¹„ë¡€") {
                    let council = c.metropolitan.replace("íŠ¹ë³„ì‹œ", "ì‹œì˜íšŒ").replace("ê´‘ì—­ì‹œ", "ì‹œì˜íšŒ").replace("íŠ¹ë³„ìì¹˜ì‹œ", "ì‹œì˜íšŒ").replace("íŠ¹ë³„ìì¹˜ë„", "ë„ì˜íšŒ").replace("ë„", "ë„ì˜íšŒ");
                    shareTextContent = `[ê°œí˜ì‹ ë‹¹] ${council} ë¹„ë¡€ëŒ€í‘œ ${roleLabel} ${name} ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”!`;
                } else {
                    let council = c.metropolitan;
                    if (council.endsWith("íŠ¹ë³„ì‹œ") || council.endsWith("ê´‘ì—­ì‹œ")) council = council.substring(0, 2) + "ì‹œì˜íšŒ";
                    else if (council === "ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ") council = "ì„¸ì¢…ì‹œì˜íšŒ";
                    else if (council === "ì œì£¼íŠ¹ë³„ìì¹˜ë„") council = "ì œì£¼ë„ì˜íšŒ"; 
                    else if (council.endsWith("ë„")) council = council.substring(0, 2) + "ë„ì˜íšŒ";
                    
                    const regionName = c.constituencyFull || `${c.shortMetro || c.region} ${c.district}ì„ ê±°êµ¬`;
                    let fullTitle = regionName;
                    if (!regionName.startsWith(council)) {
                        fullTitle = `${council} ${regionName}`;
                    }
                    shareTextContent = `[ê°œí˜ì‹ ë‹¹] ${fullTitle} ${roleLabel} ${name} ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”!`;
                }
            } else if (c.category === "ê¸°ì´ˆì˜ì›") {
                if (c.district) {
                    shareTextContent = `[ê°œí˜ì‹ ë‹¹] ${c.region} ${c.district}ì„ ê±°êµ¬ ${roleLabel} ${name} ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”!`;
                } else {
                    shareTextContent = `[ê°œí˜ì‹ ë‹¹] ${c.office} ${roleLabel} ${name} ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”!`;
                }
            } else {
                shareTextContent = `[ê°œí˜ì‹ ë‹¹] ${c.office || 'í›„ë³´'} ${roleLabel} ${name} ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”!`;
            }

            const shareUrl = `${window.location.origin}${window.location.pathname}?candidate=${encodeURIComponent(name)}`;
            const shareText = shareTextContent;

            if (navigator.share) {
                navigator.share({
                    title: shareText,
                    text: shareText,
                    url: shareUrl,
                }).catch(console.error);
            } else {
                const textArea = document.createElement("textarea");
                textArea.value = `${shareText}\n${shareUrl}`;
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    alert('í›„ë³´ì ì •ë³´ë¥¼ ë³µì‚¬í–ˆìŠµë‹ˆë‹¤!\nì›í•˜ëŠ” ê³³ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.');
                } catch (err) {
                    alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
                document.body.removeChild(textArea);
            }
        };

        window.shareToSNS = function(platform) {
            const url = encodeURIComponent(window.location.href);
            const title = encodeURIComponent(document.title);
            let link = '';
            
            if (platform === 'facebook') {
                link = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
            } else if (platform === 'x') {
                link = `https://twitter.com/intent/tweet?text=${title}&url=${url}`;
            }
            
            if (link) {
                window.open(link, '_blank', 'width=600,height=400');
            }
        };

        window.copyLink = function() {
            const url = window.location.href;
            if (navigator.clipboard) {
                navigator.clipboard.writeText(url).then(() => {
                    alert('ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                }).catch(() => {
                    alert('ë§í¬ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                });
            } else {
                const textArea = document.createElement("textarea");
                textArea.value = url;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand("Copy");
                textArea.remove();
                alert('ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }
        };

        /* PWA ì„¤ì¹˜ ë¡œì§ */
        let deferredPrompt;
        const installBtn = document.getElementById('pwa-install-btn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.style.display = 'inline-flex'; // ì„¤ì¹˜ ê°€ëŠ¥í•˜ë©´ ë²„íŠ¼ í‘œì‹œ
        });

        installBtn.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') {
                    console.log('User accepted the install prompt');
                }
                deferredPrompt = null;
                installBtn.style.display = 'none';
            }
        });

        window.addEventListener('appinstalled', () => {
            console.log('PWA was installed');
            installBtn.style.display = 'none';
        });

        /* Service Worker ë“±ë¡ */
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js').then(reg => {
                    console.log('SW registered:', reg);
                }).catch(err => {
                    console.log('SW registration failed:', err);
                });
            });
        }

        /* GLOBAL DATA & UTILITY FUNCTIONS */
        /* [ì¤‘ìš”] ì™¸ë¶€ íŒŒì¼ì—ì„œ ë°ì´í„° ë¡œë“œ (ì•ˆì „ì¥ì¹˜ ì¶”ê°€) */
        const regionPriority = (window.regionPriority) ? window.regionPriority : {};
        const candidates = (window.candidates) ? window.candidates : [];

        // ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì•Œë¦¼
        if (!window.candidates || window.candidates.length === 0) {
            console.error("í›„ë³´ì ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. candidates.js íŒŒì¼ ê²½ë¡œì™€ ë¬¸ë²•ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
            // alert("í›„ë³´ì ë°ì´í„° ë¡œë”© ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\nìƒˆë¡œê³ ì¹¨ í•˜ê±°ë‚˜ ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.");
        }

        /* ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ */
        function isNewCandidate(dateStr) {
            if (!dateStr) return false;
            const addedDate = new Date(dateStr);
            const now = new Date();
            now.setHours(0,0,0,0);
            addedDate.setHours(0,0,0,0);
            const diffTime = now - addedDate;
            const diffDays = diffTime / (1000 * 60 * 60 * 24);
            return diffDays >= 0 && diffDays <= 7;
        }

        function getCleanOffice(c) {
            let baseOffice = c.office || "";
            if (c.category === "ê´‘ì—­ì˜ì›") {
                const metro = c.metropolitan || "";
                if (metro.endsWith("íŠ¹ë³„ì‹œ") || metro.endsWith("ê´‘ì—­ì‹œ")) {
                    baseOffice = metro.replace(/(íŠ¹ë³„ì‹œ|ê´‘ì—­ì‹œ)$/, "") + "ì‹œì˜íšŒ";
                } else if (metro.endsWith("íŠ¹ë³„ìì¹˜ì‹œ")) {
                    baseOffice = "ì„¸ì¢…ì‹œì˜íšŒ";
                } else if (metro.endsWith("ë„") || metro.endsWith("íŠ¹ë³„ìì¹˜ë„")) {
                    baseOffice = metro.replace(/(íŠ¹ë³„ìì¹˜ë„|ë„)$/, "") + "ë„ì˜íšŒ";
                }
                return baseOffice;
            }
            if (c.category === "ê¸°ì´ˆì˜ì›") {
                const parts = c.region.split(' ');
                const cityOrGu = parts[parts.length - 1];
                baseOffice = cityOrGu + "ì˜íšŒ"; 
            }
            if (c.name === "ê¹€ìˆœì£¼") {
                baseOffice = "ì„¸ì¢…ì‹œì˜ì›";
            }
            return baseOffice.replace(/\s*í›„ë³´\s*$/, ""); 
        }

        const councilSort = (a, b) => (a.region || "").localeCompare(b.region || "") || (a.district || "").localeCompare(b.district || "");

        function updateSummary() {
            const getCount = (cat) => candidates.filter(c => c.category === cat).length;
            const els = { 'sum-by': getCount("ì¬ë³´ê¶ì„ ê±°"), 'sum-prov-exec': getCount("ê´‘ì—­ë‹¨ì²´ì¥"), 'sum-local-exec': getCount("ê¸°ì´ˆë‹¨ì²´ì¥"), 'sum-prov-council': getCount("ê´‘ì—­ì˜ì›"), 'sum-local-council': getCount("ê¸°ì´ˆì˜ì›"), 'sum-total': candidates.length };
            for (let id in els) { const el = document.getElementById(id); if (el) el.innerText = els[id]; }
            const regionGrid = document.getElementById('region-status-grid');
            if (regionGrid) {
                const shortNameMap = { "ì„œìš¸íŠ¹ë³„ì‹œ": "ì„œìš¸", "ë¶€ì‚°ê´‘ì—­ì‹œ": "ë¶€ì‚°", "ëŒ€êµ¬ê´‘ì—­ì‹œ": "ëŒ€êµ¬", "ì¸ì²œê´‘ì—­ì‹œ": "ì¸ì²œ", "ê´‘ì£¼ê´‘ì—­ì‹œ": "ê´‘ì£¼", "ëŒ€ì „ê´‘ì—­ì‹œ": "ëŒ€ì „", "ìš¸ì‚°ê´‘ì—­ì‹œ": "ìš¸ì‚°", "ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ": "ì„¸ì¢…", "ê²½ê¸°ë„": "ê²½ê¸°", "ê°•ì›íŠ¹ë³„ìì¹˜ë„": "ê°•ì›", "ì¶©ì²­ë¶ë„": "ì¶©ë¶", "ì¶©ì²­ë‚¨ë„": "ì¶©ë‚¨", "ì „ë¶íŠ¹ë³„ìì¹˜ë„": "ì „ë¶", "ì „ë¼ë‚¨ë„": "ì „ë‚¨", "ê²½ìƒë¶ë„": "ê²½ë¶", "ê²½ìƒë‚¨ë„": "ê²½ë‚¨", "ì œì£¼íŠ¹ë³„ìì¹˜ë„": "ì œì£¼" };
                let gridHtml = '';
                Object.keys(regionPriority).forEach(region => {
                    const count = candidates.filter(c => c.metropolitan === region || c.region === region).length;
                    gridHtml += `<div class="region-box cursor-pointer" onclick="renderRegionView('${region}')"><p class="text-gray-500 text-[10px] font-bold">${shortNameMap[region]}</p><p class="text-lg font-black ${count > 0 ? 'text-[#FF6600]' : 'text-gray-700 dark:text-slate-400'}">${count}</p></div>`;
                });
                regionGrid.innerHTML = gridHtml;
            }
        }

        function updateNavActive(id) { 
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active')); 
            const target = document.getElementById(id); 
            if(target) target.classList.add('active'); 
        }

        function scrollToId(id) { 
            const isRegionMode = document.getElementById('btn-region').classList.contains('active'); 
            if (id === 'top') { 
                if (isRegionMode) renderOriginalView(); 
                window.scrollTo({ top: 0, behavior: 'smooth' }); 
                return; 
            } 
            if (isRegionMode) { 
                renderOriginalView(); 
                setTimeout(() => { 
                    const el = document.getElementById(id); 
                    if (el) el.scrollIntoView({ behavior: 'smooth' }); 
                }, 150); 
            } else { 
                const el = document.getElementById(id); 
                if (el) el.scrollIntoView({ behavior: 'smooth' }); 
            } 
        }

        function openProfileModal(name) {
            const c = candidates.find(cand => cand.name === name);
            if (!c) return;
            document.getElementById('modal-name').innerText = c.name;
            currentModalCandidateName = c.name;
            
            const isConfirmed = (c.status === "í›„ë³´" && c.name !== "ê¹€ì„±ë¯¼" && c.name !== "ì´ìˆ˜ì°¬" && c.name !== "ë°•ì¢…ê¸¸");
            let statusLabel = isConfirmed ? "í›„ë³´" : (c.name === "ì†¡ì§„ì˜" ? "ì¶œë§ˆì˜ˆì •" : ((c.decl && c.decl !== "#") ? "ì¶œë§ˆì„ ì–¸" : "ì¶œë§ˆì˜ˆì •"));
            
            let displayOfficeLabel = "";
            if (c.name === "ì„œìš´êµ") displayOfficeLabel = "ëŒ€êµ¬ê´‘ì—­ì‹œì˜íšŒ ìˆ˜ì„±êµ¬ ì œ3ì„ ê±°êµ¬ í›„ë³´";
            else if (c.name === "ì–‘í•´ë‘") displayOfficeLabel = "ì œì£¼íŠ¹ë³„ìì¹˜ë„ì˜íšŒ ì œì£¼ì‹œ ì™¸ë„ë™Â·ì´í˜¸ë™Â·ë„ë‘ë™ ì„ ê±°êµ¬ í›„ë³´";
            else if (c.name === "ì´ê±´ìš°") displayOfficeLabel = "ì œì£¼íŠ¹ë³„ìì¹˜ë„ì˜íšŒ ì œì£¼ì‹œ ë…¸í˜•ë™ ì„ ê±°êµ¬ í›„ë³´";
            else if (c.name === "ìµœí˜„ì„") displayOfficeLabel = "ì„œìš¸íŠ¹ë³„ì‹œì˜íšŒ ì†¡íŒŒêµ¬ ì œ2 ì„ ê±°êµ¬ í›„ë³´";
            else if (c.name === "ì´ì¬ì›") displayOfficeLabel = "ì„œìš¸íŠ¹ë³„ì‹œì˜íšŒ ë¹„ë¡€ëŒ€í‘œ ì¶œë§ˆì˜ˆì •";
            else if (c.name === "ê°•ì¸ìˆ˜") displayOfficeLabel = "ì„œìš¸íŠ¹ë³„ì‹œì˜íšŒ ê°•ë‚¨êµ¬ ì œ1 ì„ ê±°êµ¬ í›„ë³´";
            else if (c.name === "ê¹€ìˆœì£¼") displayOfficeLabel = "ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œì˜íšŒ ì œ4 ì„ ê±°êµ¬ í›„ë³´";
            else {
                let districtLabel = c.district ? ` ${c.district}ì„ ê±°êµ¬` : "";
                const displayOffice = getCleanOffice(c);
                displayOfficeLabel = `${displayOffice}${districtLabel} ${statusLabel}`;
            }

            document.getElementById('modal-office').innerText = displayOfficeLabel;
            
            const subRegionEl = document.getElementById('modal-subregion');
            subRegionEl.innerText = c.subRegion || "";
            document.getElementById('modal-photo-area').innerHTML = c.photo ? `<img src="${c.photo}" class="w-full h-full object-contain" style="object-position: center top" alt="ê°œí˜ì‹ ë‹¹ ${c.name} í›„ë³´ í”„ë¡œí•„">` : `<div class="no-photo-placeholder"><i data-lucide="user-round" class="w-12 h-12"></i><span>ì´ë¯¸ì§€ ì¤€ë¹„ì¤‘</span></div>`;
            
            const snsBtns = { 
                fb: document.getElementById('modal-fb'), 
                ig: document.getElementById('modal-ig'), 
                threads: document.getElementById('modal-threads'), 
                yt: document.getElementById('modal-yt'), 
                blog: document.getElementById('modal-blog'),
                site: document.getElementById('modal-site')
            };
            for (let k in snsBtns) { 
                if (c.sns && c.sns[k] && c.sns[k] !== "#") { 
                    snsBtns[k].style.display = 'flex'; 
                    snsBtns[k].href = c.sns[k]; 
                } else { 
                    snsBtns[k].style.display = 'none'; 
                } 
            }
            
            const declBtn = document.getElementById('modal-declaration');
            if (c.decl && c.decl !== "#") {
                declBtn.style.display = 'block';
                declBtn.href = c.decl;
            } else {
                declBtn.style.display = 'none';
            }

            // SEO ì—…ë°ì´íŠ¸ í˜¸ì¶œ
            const description = c.bio ? c.bio[0].replace(/<[^>]*>?/gm, '') : "";
            updateMetadata(c.name, displayOfficeLabel, description);

            const overlay = document.getElementById('profile-modal-overlay'); 
            overlay.style.display = 'flex'; 
            setTimeout(() => overlay.classList.add('active'), 10);
            lucide.createIcons();
        }

        function closeProfileModal() { 
            const overlay = document.getElementById('profile-modal-overlay'); 
            overlay.classList.remove('active'); 
            setTimeout(() => { 
                overlay.style.display = 'none'; 
                document.body.style.overflow = ''; 
                currentModalCandidateName = '';
                // SEO ì´ˆê¸°í™”
                updateMetadata(null);
            }, 300); 
        }

        function renderOriginalView() {
            updateNavActive('btn-original');
            const container = document.getElementById('content-area');
            const provCouncilCands = candidates.filter(c => c.category === "ê´‘ì—­ì˜ì›").sort((a, b) => {
                const priA = regionPriority[a.metropolitan] || 99;
                const priB = regionPriority[b.metropolitan] || 99;
                if (priA !== priB) return priA - priB;
                const isProA = a.constituency === "ë¹„ë¡€";
                const isProB = b.constituency === "ë¹„ë¡€";
                if (isProA && !isProB) return 1;  
                if (!isProA && isProB) return -1; 
                return (a.district || a.constituencyFull || "").localeCompare(b.district || b.constituencyFull || "");
            });
            const filterByMetro = (metro) => candidates.filter(c => c.category === "ê¸°ì´ˆì˜ì›" && c.metropolitan === metro).sort(councilSort);
            const seoulCands = filterByMetro("ì„œìš¸íŠ¹ë³„ì‹œ");
            const daeguCands = filterByMetro("ëŒ€êµ¬ê´‘ì—­ì‹œ");
            const incheonCands = filterByMetro("ì¸ì²œê´‘ì—­ì‹œ");
            const daejeonCands = filterByMetro("ëŒ€ì „ê´‘ì—­ì‹œ");
            const gyeonggiCands = filterByMetro("ê²½ê¸°ë„");
            const chungnamCands = filterByMetro("ì¶©ì²­ë‚¨ë„");
            const gyeongbukCands = filterByMetro("ê²½ìƒë¶ë„");
            const excluded = ["ì„œìš¸íŠ¹ë³„ì‹œ", "ëŒ€êµ¬ê´‘ì—­ì‹œ", "ëŒ€ì „ê´‘ì—­ì‹œ", "ì¸ì²œê´‘ì—­ì‹œ", "ê²½ê¸°ë„", "ê²½ìƒë¶ë„", "ì¶©ì²­ë‚¨ë„"];
            const otherCands = candidates.filter(c => !excluded.includes(c.metropolitan) && c.category === "ê¸°ì´ˆì˜ì›").sort((a, b) => (regionPriority[a.metropolitan] || 99) - (regionPriority[b.metropolitan] || 99) || councilSort(a, b));

            container.innerHTML = `
                <section id="provincial-exec" class="scroll-mt-24"><h2 class="section-title">ê´‘ì—­ìì¹˜ë‹¨ì²´ì¥</h2><div class="grid-responsive">${candidates.filter(c => c.category === "ê´‘ì—­ë‹¨ì²´ì¥").map(createCard).join('')}</div></section>
                <section id="local-exec" class="scroll-mt-24">
                    <h2 class="section-title">ê¸°ì´ˆìì¹˜ë‹¨ì²´ì¥</h2>
                    <div class="grid-responsive">
                        ${candidates.filter(c => c.category === "ê¸°ì´ˆë‹¨ì²´ì¥")
                            .sort((a, b) => (regionPriority[a.metropolitan] || 99) - (regionPriority[b.metropolitan] || 99) || (a.region || "").localeCompare(b.region || ""))
                            .map(createCard).join('')}
                    </div>
                </section>
                <section id="provincial-council" class="scroll-mt-24"><h2 class="section-title">ê´‘ì—­ì˜íšŒì˜ì›</h2><div class="grid-responsive">${provCouncilCands.map(createCard).join('')}</div></section>
                <section id="local-council" class="mb-16 scroll-mt-24">
                    <h2 class="section-title">ê¸°ì´ˆì˜íšŒì˜ì›</h2>
                    ${seoulCands.length > 0 ? `<div class="mb-8"><h3 class="sub-section-title">ì„œìš¸íŠ¹ë³„ì‹œ</h3><div class="grid-responsive">${seoulCands.map(createCard).join('')}</div></div>` : ''}
                    ${daeguCands.length > 0 ? `<div class="mb-8"><h3 class="sub-section-title">ëŒ€êµ¬ê´‘ì—­ì‹œ</h3><div class="grid-responsive">${daeguCands.map(createCard).join('')}</div></div>` : ''}
                    ${incheonCands.length > 0 ? `<div class="mb-8"><h3 class="sub-section-title">ì¸ì²œê´‘ì—­ì‹œ</h3><div class="grid-responsive">${incheonCands.map(createCard).join('')}</div></div>` : ''}
                    ${daejeonCands.length > 0 ? `<div class="mb-8"><h3 class="sub-section-title">ëŒ€ì „ê´‘ì—­ì‹œ</h3><div class="grid-responsive">${daejeonCands.map(createCard).join('')}</div></div>` : ''}
                    ${gyeonggiCands.length > 0 ? `<div class="mb-8"><h3 class="sub-section-title">ê²½ê¸°ë„</h3><div class="grid-responsive">${gyeonggiCands.map(createCard).join('')}</div></div>` : ''}
                    ${chungnamCands.length > 0 ? `<div class="mb-8"><h3 class="sub-section-title">ì¶©ì²­ë‚¨ë„</h3><div class="grid-responsive">${chungnamCands.map(createCard).join('')}</div></div>` : ''}
                    ${gyeongbukCands.length > 0 ? `<div class="mb-8"><h3 class="sub-section-title">ê²½ìƒë¶ë„</h3><div class="grid-responsive">${gyeongbukCands.map(createCard).join('')}</div></div>` : ''}
                    ${otherCands.length > 0 ? `<div><h3 class="sub-section-title">ê¸°íƒ€ ì§€ì—­</h3><div class="grid-responsive">${otherCands.map(createCard).join('')}</div></div>` : ''}
                </section>
            `;
            updateSummary(); 
            lucide.createIcons();
        }

        function renderRegionView(targetRegion = null) {
            updateNavActive('btn-region');
            const container = document.getElementById('content-area');
            let html = '<div class="mb-16">';
            Object.keys(regionPriority).forEach(m => {
                const regionalCandidates = candidates.filter(c => c.metropolitan === m || c.region === m).sort((a, b) => {
                    const catOrder = {"ê´‘ì—­ë‹¨ì²´ì¥": 1, "ê¸°ì´ˆë‹¨ì²´ì¥": 2, "ê´‘ì—­ì˜ì›": 3, "ê¸°ì´ˆì˜ì›": 4};
                    const catDiff = (catOrder[a.category] || 5) - (catOrder[b.category] || 5);
                    if (catDiff !== 0) return catDiff;

                    if (a.category === "ê´‘ì—­ì˜ì›" || a.category === "ê¸°ì´ˆì˜ì›") {
                        const isAPro = a.constituency === "ë¹„ë¡€" || a.district === "ë¹„ë¡€";
                        const isBPro = b.constituency === "ë¹„ë¡€" || b.district === "ë¹„ë¡€";
                        if (isAPro !== isBPro) return isAPro ? 1 : -1;
                        
                        const nameA = (a.region || "") + (a.district || a.constituencyFull || "");
                        const nameB = (b.region || "") + (b.district || b.constituencyFull || "");
                        return nameA.localeCompare(nameB, 'ko');
                    }
                    return (a.name || "").localeCompare(b.name || "", 'ko');
                });
                if(regionalCandidates.length > 0) {
                    html += `<section id="region-${m}" class="mb-12 scroll-mt-24"><h2 class="section-title">${m}</h2><div class="grid-responsive">${regionalCandidates.map(createCard).join('')}</div></section>`;
                }
            });
            container.innerHTML = html + '</div>';
            lucide.createIcons();
            if (targetRegion) { 
                const el = document.getElementById(`region-${targetRegion}`); 
                if (el) el.scrollIntoView({ behavior: 'smooth' }); 
            }
            else { 
                const seoulEl = document.getElementById('region-ì„œìš¸íŠ¹ë³„ì‹œ'); 
                if (seoulEl) seoulEl.scrollIntoView({ behavior: 'smooth' }); 
            }
        }

        window.onload = function() {
            initDarkMode();
            const diff = Math.ceil((new Date('2026-06-03') - new Date().setHours(0,0,0,0)) / (1000*60*60*24));
            const badge = document.getElementById('d-day-badge');
            if (badge) badge.innerText = diff > 0 ? `D-${diff}` : (diff === 0 ? 'D-Day' : `D+${Math.abs(diff)}`);
            
            const expiryDate = new Date('2026-02-22'); 
            const today = new Date();
            if (today >= expiryDate) {
                const sBadge = document.getElementById('seoul-map-new-badge');
                const gBadge = document.getElementById('gyeonggi-map-new-badge');
                if (sBadge) sBadge.style.display = 'none';
                if (gBadge) gBadge.style.display = 'none';
            }

            const params = new URLSearchParams(window.location.search);
            const candidateName = params.get('candidate');
            if (candidateName) {
                const target = candidates.find(c => c.name === candidateName);
                if (target) {
                    openProfileModal(candidateName);
                }
            }
            
            renderOriginalView();
        };

        function createCard(c) {
            const isTightBio = ["ê¹€íƒœìˆ˜", "ê³ ì¬ìœ¤", "ì´ê°•ë¯¼", "ì˜¤ì •ëŒ€", "ìš°ì˜í›ˆ", "ìµœìœ¤ì„", "êµ¬ì„±ë„", "ë°•ì„±ì§„", "ì£¼í•œì†¡", "ìµœì œì¼", "ì‹¬ìš©ì§„", "ë°•ì¢…ê¸¸", "í•˜ëŒ€ì‹", "ì†¡ì›ê·¼", "ì´í˜¸ì—½", "í•˜ìš©ì¤€", "ê¹€ì˜ë¯¼", "ì†ìŠ¹ë²”"].includes(c.name);
            const isTightSpacing = ["ìš°ì˜í›ˆ", "ê¹€íƒœìˆ˜", "ì‹¬ìš©ì§„"].includes(c.name);
            let styles = [];
            if (isTightBio || ["í•˜ëŒ€ì‹", "ì¡°ë™ìš´", "ë°•ì² í˜„", "ê¹€ì„±ë¯¼", "ë¥˜íƒœí•˜", "ì´ìš©ìš°", "ì´ì¬ì›", "ê¹€ë³‘ì§„", "ì–‘ì„±í˜", "ì–‘ì¤€ëª¨"].includes(c.name)) {
                styles.push("line-height: 1.05");
            }
            if (isTightSpacing) { styles.push("letter-spacing: -0.08em"); }
            if (c.name === "ì‹¬ìš©ì§„") { styles.push("align-items: flex-start; text-align: left;"); }
            
            const bioStyleAttr = styles.length > 0 ? `style="${styles.join('; ')};"` : "";

            let bioHtml = c.bio.map((line, idx) => `<div class="flex items-center justify-center">${line}</div>`).join('');
            let leftTagText = c.region;
            if (c.category === "ê¸°ì´ˆì˜ì›") {
                const isMetropolitan = c.metropolitan && (c.metropolitan.endsWith('íŠ¹ë³„ì‹œ') || c.metropolitan.endsWith('ê´‘ì—­ì‹œ') || c.metropolitan.endsWith('íŠ¹ë³„ìì¹˜ì‹œ'));
                if (isMetropolitan) { 
                    leftTagText = c.region;
                    if(c.name === "ê¹€ì„±ì¡°" || c.name === "ì´ë™í˜„") leftTagText = "ê²½ë¶ " + c.region.replace("ê²½ìƒë¶ë„ ", "");
                } 
                else { leftTagText = c.region.replace("ê²½ê¸°ë„", "ê²½ê¸°").replace("ì¶©ì²­ë‚¨ë„", "ì¶©ë‚¨").replace("ê²½ìƒë¶ë„", "ê²½ë¶").replace("ì „ë¼ë¶ë„", "ì „ë¶").replace("ì¶©ì²­ë¶ë„", "ì¶©ë¶").replace("ê²½ìƒë‚¨ë„", "ê²½ë‚¨").replace("ì „ë¼ë‚¨ë„", "ì „ë‚¨").replace("ê°•ì›íŠ¹ë³„ìì¹˜ë„", "ê°•ì›").replace("ì œì£¼íŠ¹ë³„ìì¹˜ë„", "ì œì£¼"); }
            } else if (c.category === "ê´‘ì—­ì˜ì›") {
                leftTagText = (c.shortMetro || c.region);
            }
            let rightTagText = c.district || (c.constituency === "ë¹„ë¡€" ? "ë¹„ë¡€" : "");
            let districtTag = rightTagText ? `<div class="district-tag dark:bg-slate-900 dark:text-orange-50 dark:border-orange-500">${rightTagText}</div>` : "";
            const isNoPhoto = !c.photo || c.photo.trim() === "";
            const fit = c.cardFit || "cover";
            const pos = c.cardPos || "center top"; 
            const scale = c.cardScale || "1";
            const photoContent = isNoPhoto 
                ? `<div class="no-photo-placeholder"><i data-lucide="user-round" class="w-12 h-12"></i><span>ì´ë¯¸ì§€ ì¤€ë¹„ì¤‘</span></div>`
                : `<img src="${c.photo}" class="candidate-photo ${!c.cardFit ? 'photo-face-focus' : ''}" style="object-fit: ${fit} !important; object-position: ${pos} !important; transform: scale(${scale});" alt="ê°œí˜ì‹ ë‹¹ ${c.name} í›„ë³´ í”„ë¡œí•„">`;
            
            const hasNewBadge = isNewCandidate(c.dateAdded);
            const newBadgeHtml = hasNewBadge ? `<span class="new-badge">NEW</span>` : "";
            
            const displayOffice = getCleanOffice(c);
            
            const isConfirmed = (c.status === "í›„ë³´" && c.name !== "ê¹€ì„±ë¯¼" && c.name !== "ì´ìˆ˜ì°¬" && c.name !== "ë°•ì¢…ê¸¸");
            const confirmedBadge = isConfirmed ? `<div class="confirmed-badge"><i data-lucide="check-circle" style="width: 10px; height: 10px;"></i>ê³µì²œ í™•ì •</div>` : "";

            let statusLabel = "";
            if (isConfirmed) statusLabel = "í›„ë³´";
            else if (c.name === "ì†¡ì§„ì˜") statusLabel = "ì¶œë§ˆì˜ˆì •";
            else statusLabel = (c.decl && c.decl !== "#") ? "ì¶œë§ˆì„ ì–¸" : "ì¶œë§ˆì˜ˆì •";

            return `
                <div onclick="openProfileModal('${c.name}')" class="bg-white dark:bg-slate-800 rounded-[1rem] md:rounded-[1.5rem] shadow-md border border-gray-100 dark:border-slate-700 card-hover transition-all duration-500 overflow-hidden flex flex-col h-full cursor-pointer">
                    <div class="photo-frame">
                        <div class="region-tag">${leftTagText}</div>
                        ${districtTag}
                        ${confirmedBadge}
                        ${photoContent}
                    </div>
                    <div class="pt-2 px-3 pb-4 md:pt-4 md:px-6 md:pb-6 text-center flex flex-col flex-grow">
                        <h3 class="text-base md:text-xl font-bold mb-1 dark:text-white tracking-wider flex items-center justify-center">${c.name}${newBadgeHtml}</h3>
                        <div class="bio-text" ${bioStyleAttr}>${bioHtml}</div>
                        <div class="mt-auto nrp-bg-orange text-white py-2 rounded-xl font-bold text-[10px] md:text-sm leading-tight text-center">${displayOffice} ${statusLabel}</div>
                    </div>
                </div>
            `;
        }
    </script>

   <script src="candidates.js?v=20240216_1"></script>
   <script src="data.js?v=20240216_1"></script>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // ì „ì—­ ë³€ìˆ˜ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
        const SEOUL_INITIAL_DISTRICTS = window.SEOUL_INITIAL_DISTRICTS;
        const GYEONGGI_INITIAL_DISTRICTS = window.GYEONGGI_INITIAL_DISTRICTS;

        const EMPTY_GRAY_PALETTE = ["#cbd5e1", "#b1b9c6", "#94a3b8", "#a8b2c1", "#bdc6d4"];
        const EMPTY_GRAY_PALETTE_DARK = ["#1e293b", "#334155", "#0f172a", "#111827", "#1e1b4b"];
        const ACTIVE_ORANGE_PALETTE = ["#FF6600", "#FF8233", "#FFA366", "#FFC499"]; 
        const CITY_ORDER = ["ê°€í‰êµ°", "ê³ ì–‘ì‹œ", "ê³¼ì²œì‹œ", "ê´‘ëª…ì‹œ", "ê´‘ì£¼ì‹œ", "êµ¬ë¦¬ì‹œ", "êµ°í¬ì‹œ", "ê¹€í¬ì‹œ", "ë‚¨ì–‘ì£¼ì‹œ", "ë™ë‘ì²œì‹œ", "ë¶€ì²œì‹œ", "ì„±ë‚¨ì‹œ", "ìˆ˜ì›ì‹œ", "ì‹œí¥ì‹œ", "ì•ˆì‚°ì‹œ", "ì•ˆì„±ì‹œ", "ì•ˆì–‘ì‹œ", "ì–‘ì£¼ì‹œ", "ì–‘í‰êµ°", "ì—¬ì£¼ì‹œ", "ì—°ì²œêµ°", "ì˜¤ì‚°ì‹œ", "ìš©ì¸ì‹œ", "ì˜ì™•ì‹œ", "ì˜ì •ë¶€ì‹œ", "ì´ì²œì‹œ", "íŒŒì£¼ì‹œ", "í‰íƒì‹œ", "í¬ì²œì‹œ", "í•˜ë‚¨ì‹œ", "í™”ì„±ì‹œ"];

        const normalizeFunc = (s) => String(s || "")
            .replace(/[ì œÂ·\s]/g, "")
            .replace(/[ABC]$/, "")
            .replace("ä¸­å¤®", "ì¤‘ì•™");

        const IntegratedProfile = ({ can }) => {
            const isValidLink = (link) => link && link !== "" && link !== "#";
            
            const getStatusLabel = (c) => {
                const isConfirmed = (c.status === "í›„ë³´" && c.name !== "ê¹€ì„±ë¯¼" && c.name !== "ì´ìˆ˜ì°¬" && c.name !== "ë°•ì¢…ê¸¸");
                if (isConfirmed) return "í›„ë³´";
                if (c.name === "ì†¡ì§„ì˜") return "ì¶œë§ˆì˜ˆì •";
                return (c.decl && c.decl !== "#") ? "ì¶œë§ˆì„ ì–¸" : "ì¶œë§ˆì˜ˆì •";
            };

            let displayOfficeLabel = "";
            if (can.name === "ì„œìš´êµ") displayOfficeLabel = "ëŒ€êµ¬ê´‘ì—­ì‹œì˜íšŒ ìˆ˜ì„±êµ¬ ì œ3ì„ ê±°êµ¬ í›„ë³´";
            else if (can.name === "ì–‘í•´ë‘") displayOfficeLabel = "ì œì£¼íŠ¹ë³„ìì¹˜ë„ì˜íšŒ ì œì£¼ì‹œ ì™¸ë„ë™Â·ì´í˜¸ë™Â·ë„ë‘ë™ ì„ ê±°êµ¬ í›„ë³´";
            else if (can.name === "ì´ê±´ìš°") displayOfficeLabel = "ì œì£¼íŠ¹ë³„ìì¹˜ë„ì˜íšŒ ì œì£¼ì‹œ ë…¸í˜•ë™ ì„ ê±°êµ¬ í›„ë³´";
            else if (can.name === "ìµœí˜„ì„") displayOfficeLabel = "ì„œìš¸íŠ¹ë³„ì‹œì˜íšŒ ì†¡íŒŒêµ¬ ì œ2 ì„ ê±°êµ¬ í›„ë³´";
            else if (can.name === "ì´ì¬ì›") displayOfficeLabel = "ì„œìš¸íŠ¹ë³„ì‹œì˜íšŒ ë¹„ë¡€ëŒ€í‘œ ì¶œë§ˆì˜ˆì •";
            else if (can.name === "ê°•ì¸ìˆ˜") displayOfficeLabel = "ì„œìš¸íŠ¹ë³„ì‹œì˜íšŒ ê°•ë‚¨êµ¬ ì œ1 ì„ ê±°êµ¬ í›„ë³´";
            else if (can.name === "ê¹€ìˆœì£¼") displayOfficeLabel = "ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œì˜íšŒ ì œ4 ì„ ê±°êµ¬ í›„ë³´";
            else {
                const regionParts = can.region.split(' ');
                const cityName = regionParts[regionParts.length - 1]; 
                const districtLabel = can.district ? ` ${can.district}ì„ ê±°êµ¬` : "";
                displayOfficeLabel = `${cityName}ì˜íšŒ${districtLabel} ${getStatusLabel(can)}`;
            }

            useEffect(() => {
                if (typeof lucide !== 'undefined') lucide.createIcons();
            }, [can]);

            return (
                <div className="h-full flex flex-col overflow-hidden text-slate-800 dark:text-slate-200">
                    <div className="flex flex-row h-auto shrink-0 gap-4 sm:gap-6">
                        <div className="w-1/4 aspect-square sm:w-[40%] sm:aspect-auto bg-orange-50 dark:bg-slate-700 border border-orange-100 dark:border-slate-600 rounded-xl sm:rounded-2xl flex items-center justify-center shadow-inner overflow-hidden shrink-0">
                            {can.photo ? (
                                <img src={can.photo} className="w-full h-full object-cover" alt={`ê°œí˜ì‹ ë‹¹ ${can.name} í›„ë³´ í”„ë¡œí•„`} />
                            ) : (
                                <div className="flex flex-col items-center justify-center text-orange-200 dark:text-slate-500">
                                    <i data-lucide="user" className="w-8 h-8 sm:w-16 sm:h-16 opacity-30"></i>
                                    <span className="text-[8px] font-black uppercase tracking-widest mt-1 hidden sm:block">No Profile</span>
                                </div>
                            )}
                        </div>
                        <div className="flex-1 flex flex-col items-start justify-center py-1 sm:py-2">
                            <h3 className="text-lg sm:text-3xl font-black text-slate-900 dark:text-white tracking-wider mb-1 sm:mb-2">
                                {can.name}
                                {isNewCandidate(can.dateAdded) && <span className="new-badge">NEW</span>}
                            </h3>
                            <div className="px-2 py-0.5 sm:px-3 sm:py-1 bg-orange-100 dark:bg-orange-900/40 text-orange-600 dark:text-orange-400 rounded-lg text-[9px] sm:text-xs font-black uppercase mb-2 sm:mb-4">{displayOfficeLabel}</div>
                            <div className="flex gap-1.5 sm:gap-2 mb-2 sm:mb-4">
                                {isValidLink(can.sns?.fb) && <a href={can.sns.fb} target="_blank" className="p-1.5 sm:p-2 bg-orange-50 dark:bg-slate-800 text-orange-600 dark:text-orange-400 rounded-lg hover:bg-orange-500 hover:text-white transition-colors border border-orange-100 dark:border-slate-700 shadow-sm"><i data-lucide="facebook" className="w-3.5 h-3.5 sm:w-4 sm:h-4"></i></a>}
                                {isValidLink(can.sns?.ig) && <a href={can.sns.ig} target="_blank" className="p-1.5 sm:p-2 bg-orange-50 dark:bg-slate-800 text-orange-600 dark:text-orange-400 rounded-lg hover:bg-orange-500 hover:text-white transition-colors border border-orange-100 dark:border-slate-700 shadow-sm"><i data-lucide="instagram" className="w-3.5 h-3.5 sm:w-4 sm:h-4"></i></a>}
                                {isValidLink(can.sns?.blog) && <a href={can.sns.blog} target="_blank" className="p-1.5 sm:p-2 bg-orange-50 dark:bg-slate-800 text-orange-600 dark:text-orange-400 rounded-lg hover:bg-orange-500 hover:text-white transition-colors border border-orange-100 dark:border-slate-700 shadow-sm"><i data-lucide="link" className="w-3.5 h-3.5 sm:w-4 sm:h-4"></i></a>}
                                {isValidLink(can.sns?.yt) && <a href={can.sns.yt} target="_blank" className="p-1.5 sm:p-2 bg-orange-50 dark:bg-slate-800 text-orange-600 dark:text-orange-400 rounded-lg hover:bg-orange-500 hover:text-white transition-colors border border-orange-100 dark:border-slate-700 shadow-sm"><i data-lucide="youtube" className="w-3.5 h-3.5 sm:w-4 sm:h-4"></i></a>}
                            </div>
                            {isValidLink(can.decl) && (
                                <a href={can.decl} target="_blank" className="w-full sm:w-auto px-3 py-1.5 sm:py-2.5 bg-orange-500 text-white rounded-lg sm:rounded-xl text-[10px] sm:text-sm font-black text-center shadow-lg shadow-orange-200 hover:bg-orange-600 transition-all active:scale-95 flex items-center justify-center gap-1.5">
                                    <i data-lucide="file-text" className="w-3 h-3 sm:w-4 sm:h-4"></i><span className="whitespace-nowrap">ì¶œë§ˆì„ ì–¸ë¬¸ ë³´ê¸°</span>
                                </a>
                            )}
                        </div>
                    </div>
                    <div className="flex-1 mt-4 sm:mt-6 border-t border-orange-50 dark:border-slate-700 pt-4 sm:pt-6 overflow-y-auto custom-scrollbar font-bold text-slate-700 dark:text-slate-300 text-left text-[13px] sm:text-sm">
                        <div className="space-y-3 pb-4">
                            {can.bio.map((line, idx) => (
                                <div key={idx} className="flex items-start gap-3">
                                    <div className="w-1.5 h-1.5 bg-orange-500 rounded-full mt-1.5 shrink-0"></div>
                                    <span className="leading-relaxed" dangerouslySetInnerHTML={{ __html: line }}></span>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const MapDashboard = () => {
            const [geoData, setGeoData] = useState(null);
            const [guGeoData, setGuGeoData] = useState(null);
            const [selectedDistrictInfo, setSelectedDistrictInfo] = useState(null);
            const [loading, setLoading] = useState(true);

            const findDistrictName = (guName, dongName) => {
                const normalizedDong = dongName.replace(/ì œ/g, '').trim();
                for (const [distName, data] of Object.entries(SEOUL_INITIAL_DISTRICTS)) {
                    if (distName.startsWith(guName)) {
                        if (data.dongs.some(d => d.replace(/ì œ/g, '').trim() === normalizedDong)) {
                            return distName;
                        }
                    }
                }
                return null;
            };

            const getOrangeColor = (distName) => {
                const palette = ["#FF6600", "#FF8233", "#FFA366", "#FFC499"];
                const alphabet = "ê°€ë‚˜ë‹¤ë¼ë§ˆë°”ì‚¬ì•„ìì°¨ì¹´íƒ€íŒŒí•˜";
                const parts = distName.split(' ');
                const letter = parts[1] ? parts[1].replace('ì„ ê±°êµ¬', '') : '';
                const index = alphabet.indexOf(letter[0]);
                return palette[index % palette.length];
            };

            const getGreyColor = (distName) => {
                if (!distName) return document.documentElement.classList.contains('dark') ? "#1e293b" : "#F1F5F9";
                const isDark = document.documentElement.classList.contains('dark');
                const greys = isDark ? ["#1e293b", "#0f172a", "#1e1b4b", "#020617", "#030712"] : ["#E5E7EB", "#DDE1E7", "#D1D5DB", "#E2E8F0", "#CBD5E1"];
                const alphabet = "ê°€ë‚˜ë‹¤ë¼ë§ˆë°”ì‚¬ì•„ìì°¨ì¹´íƒ€íŒŒí•˜";
                const parts = distName.split(' ');
                const letter = parts[1] ? parts[1].replace('ì„ ê±°êµ¬', '') : '';
                const index = alphabet.indexOf(letter[0]);
                return greys[index % greys.length];
            };

            const matchedCandidates = useMemo(() => {
                if (!selectedDistrictInfo || !selectedDistrictInfo.district) return [];
                const guName = selectedDistrictInfo.gu;
                const distIdPart = selectedDistrictInfo.district.split(' ')[1]?.replace('ì„ ê±°êµ¬', '') || "";
                return candidates.filter(can => 
                    can.category === "ê¸°ì´ˆì˜ì›" && 
                    can.metropolitan === "ì„œìš¸íŠ¹ë³„ì‹œ" && 
                    can.region.includes(guName) && 
                    can.district === distIdPart
                );
            }, [selectedDistrictInfo]);

            const currentDistrictDongs = useMemo(() => {
                if (!selectedDistrictInfo || !selectedDistrictInfo.district) return "";
                return SEOUL_INITIAL_DISTRICTS[selectedDistrictInfo.district]?.dongs.join(', ') || "";
            }, [selectedDistrictInfo]);

            const currentDistrictSeats = useMemo(() => {
                if (!selectedDistrictInfo || !selectedDistrictInfo.district) return 0;
                return SEOUL_INITIAL_DISTRICTS[selectedDistrictInfo.district]?.seats || 0;
            }, [selectedDistrictInfo]);

            useEffect(() => {
                const dongPromise = fetch("https://raw.githubusercontent.com/vuski/admdongkor/master/ver20250401/HangJeongDong_ver20250401.geojson")
                    .then(res => res.json())
                    .then(data => { 
                        const seoulFeatures = data.features.filter(f => f.properties.adm_cd && f.properties.adm_cd.startsWith('11'));
                        setGeoData({ ...data, features: seoulFeatures }); 
                    });

                const guPromise = fetch("https://raw.githubusercontent.com/southkorea/seoul-maps/master/juso/2015/json/seoul_municipalities_geo_simple.json")
                    .then(res => res.json())
                    .then(data => {
                        setGuGeoData(data);
                    });

                Promise.all([dongPromise, guPromise]).finally(() => setLoading(false));
            }, []);

            useEffect(() => {
                if (!loading && typeof lucide !== 'undefined') lucide.createIcons();
            }, [loading, selectedDistrictInfo, matchedCandidates]);

            const project = (coords) => {
                const scale = 1800;
                const center = [126.978, 37.566];
                return [(coords[0] - center[0]) * scale * Math.cos(center[1] * Math.PI / 180) + 300, 250 - (coords[1] - center[1]) * scale];
            };

            const generatePath = (f) => {
                if (f.geometry.type === "Polygon") {
                    return "M" + f.geometry.coordinates[0].map(c => project(c).join(",")).join("L") + "Z";
                } else if (f.geometry.type === "MultiPolygon") {
                    return f.geometry.coordinates.map(p => "M" + p[0].map(c => project(c).join(",")).join("L") + "Z").join(" ");
                }
                return "";
            };

            return (
                <div className="bg-white dark:bg-slate-900 rounded-[2rem] border border-orange-100 dark:border-slate-800 shadow-xl overflow-hidden flex flex-col lg:flex-row h-[900px] lg:h-[550px]">
                    <div className="h-[400px] lg:h-auto lg:w-[55%] relative bg-slate-50 dark:bg-slate-950 flex items-center justify-center p-4 border-b lg:border-b-0 lg:border-r border-orange-50 dark:border-slate-800 shrink-0">
                        {loading ? (
                            <div className="animate-spin-custom w-10 h-10 border-4 border-orange-200 border-t-orange-500 rounded-full"></div>
                        ) : (
                            <svg viewBox="0 0 600 500" className="w-full h-full drop-shadow-lg">
                                {geoData?.features.map((f, i) => {
                                    const admNm = f.properties.adm_nm || "";
                                    const parts = admNm.split(' ');
                                    const guName = parts[1] || "";
                                    const dongName = parts[2] || "";
                                    const distName = findDistrictName(guName, dongName);
                                    const isSelected = selectedDistrictInfo && selectedDistrictInfo.district === distName;
                                    const hasCandidateInDist = distName && candidates.some(c => 
                                        c.category === "ê¸°ì´ˆì˜ì›" && 
                                        c.metropolitan === "ì„œìš¸íŠ¹ë³„ì‹œ" && 
                                        c.region.includes(guName) && 
                                        (distName.includes(c.district) || c.district === distName.split(' ')[1].replace('ì„ ê±°êµ¬', ''))
                                    );
                                    let fillStyle = isSelected ? "#FF6600" : (hasCandidateInDist ? getOrangeColor(distName) : getGreyColor(distName));
                                    const isDimmed = selectedDistrictInfo && !isSelected;

                                    return <path 
                                        key={i} 
                                        d={generatePath(f)} 
                                        fill={fillStyle} 
                                        stroke={isSelected ? "#fff" : (document.documentElement.classList.contains('dark') ? "#0f172a" : "#cbd5e1")} 
                                        strokeWidth={isSelected ? "1.5" : "0.2"} 
                                        style={{ opacity: isDimmed ? 0.2 : 1 }}
                                        className="map-path cursor-pointer hover:fill-orange-200 dark:hover:fill-orange-800" 
                                        onClick={() => {
                                            if (selectedDistrictInfo && selectedDistrictInfo.district === distName) {
                                                setSelectedDistrictInfo(null);
                                            } else {
                                                setSelectedDistrictInfo({ gu: guName, dong: dongName, district: distName });
                                            }
                                        }}
                                    >
                                        <title>{guName} {dongName} ({distName || 'ì •ë³´ì—†ìŒ'})</title>
                                    </path>;
                                })}
                                {guGeoData?.features.map((gf, gi) => (
                                    <path 
                                        key={`gu-${gi}`}
                                        d={generatePath(gf)}
                                        fill="none"
                                        stroke={document.documentElement.classList.contains('dark') ? "#cbd5e1" : "#475569"}
                                        strokeWidth="1.2"
                                        pointerEvents="none"
                                        style={{ opacity: selectedDistrictInfo ? 0.3 : 1 }}
                                    />
                                ))}
                            </svg>
                        )}
                        <div className="absolute top-4 left-4 bg-white/90 dark:bg-slate-900/90 backdrop-blur px-3 py-2 rounded-xl border border-orange-100 dark:border-slate-800 text-[11px] font-black text-orange-600 dark:text-orange-400 shadow-sm">
                            ì„œìš¸íŠ¹ë³„ì‹œ ê¸°ì´ˆì˜íšŒ ì„ ê±°êµ¬ ì§€ë„ (beta)
                        </div>
                    </div>
                    <div className="flex-1 lg:w-[45%] flex flex-col bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 overflow-hidden">
                        <div className={`p-6 transition-colors duration-300 ${selectedDistrictInfo ? 'bg-orange-500 text-white' : 'bg-gray-50 dark:bg-slate-800 text-gray-400 dark:text-slate-500'}`}>
                            <div className="flex justify-between items-start">
                                <div className="flex-1">
                                    <h2 className="text-xl lg:text-2xl font-black">{selectedDistrictInfo ? selectedDistrictInfo.district : "ì§€ë„ì˜ í–‰ì •ë™ì„ ì„ íƒí•˜ì„¸ìš”"}</h2>
                                    {selectedDistrictInfo && (
                                        <p className="mt-2 text-[11px] font-bold text-orange-50 leading-tight">
                                            {currentDistrictDongs}
                                        </p>
                                    )}
                                </div>
                                {selectedDistrictInfo && (
                                    <div className="ml-4 bg-[#1e293b] px-3 py-1.5 rounded-xl border border-white/10 text-center shrink-0 shadow-lg">
                                        <p className="text-[10px] font-black text-slate-200 leading-none mb-2.5">ì„ ê±°ì •ìˆ˜</p>
                                        <p className="text-xl font-black text-white leading-none">{currentDistrictSeats}ì¸</p>
                                    </div>
                                )}
                            </div>
                        </div>
                        <div className="flex-1 overflow-y-auto custom-scrollbar bg-white dark:bg-slate-900">
                            {selectedDistrictInfo ? (
                                matchedCandidates.length > 0 ? (
                                    <div className="divide-y divide-gray-100 dark:divide-slate-800">
                                        {matchedCandidates.map((can, idx) => {
                                            const parts = can.region.split(' ');
                                            const displayOffice = parts[parts.length - 1] + "ì˜íšŒ"; 
                                            const isConfirmed = (can.status === "í›„ë³´" && can.name !== "ê¹€ì„±ë¯¼" && can.name !== "ì´ìˆ˜ì°¬" && can.name !== "ë°•ì¢…ê¸¸");
                                            let statusText = isConfirmed ? " í›„ë³´" : (can.name === "ì†¡ì§„ì˜" ? " ì¶œë§ˆì˜ˆì •" : ((can.decl && can.decl !== "#") ? " ì¶œë§ˆì„ ì–¸" : " ì¶œë§ˆì˜ˆì •"));
                                            let fullOfficeLabel = `${displayOffice}${can.district ? ` ${can.district}ì„ ê±°êµ¬` : ""}${statusText}`;
                                            const showNew = isNewCandidate(can.dateAdded);

                                            return (
                                                <div key={idx} className="p-8 hover:bg-gray-50/50 dark:hover:bg-slate-800/30 transition-colors">
                                                    <div className="flex gap-6 items-start mb-6">
                                                        <div className="w-24 h-32 lg:w-32 lg:h-44 bg-gray-50 dark:bg-slate-800 rounded-2xl overflow-hidden shrink-0 border border-gray-100 dark:border-slate-700 shadow-sm">
                                                            {can.photo ? (
                                                                <img src={can.photo} className="w-full h-full object-cover" alt={`ê°œí˜ì‹ ë‹¹ ${can.name} í›„ë³´ í”„ë¡œí•„`} />
                                                            ) : (
                                                                <div className="w-full h-full flex flex-col items-center justify-center text-gray-200 dark:text-slate-600 bg-slate-50 dark:bg-slate-900">
                                                                    <i data-lucide="user" className="w-10 h-10 mb-1 opacity-20"></i>
                                                                    <span className="text-[8px] font-bold uppercase tracking-widest opacity-40">No Image</span>
                                                                </div>
                                                            )}
                                                        </div>
                                                        <div className="flex-1 flex flex-col items-start pt-1">
                                                            <h3 className="text-2xl lg:text-3xl font-black text-gray-900 dark:text-white mb-1 tracking-tight">
                                                                {can.name}
                                                                {showNew && <span className="new-badge">NEW</span>}
                                                            </h3>
                                                            <div className="inline-block px-3 py-1.5 bg-orange-50 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 rounded-xl text-[11px] lg:text-[12px] font-black mb-6 border border-orange-100/50 dark:border-orange-900/50">
                                                                {fullOfficeLabel}
                                                            </div>
                                                            <div className="flex gap-4 items-center mb-6">
                                                                {can.sns?.fb && can.sns.fb !== "#" && (
                                                                    <a href={can.sns.fb} target="_blank" className="sns-btn fb w-8 h-8 lg:w-10 lg:h-10 rounded-full border border-gray-100 dark:border-slate-700 shadow-sm flex items-center justify-center">
                                                                        <i data-lucide="facebook" className="w-4 h-4 lg:w-5 lg:h-5"></i>
                                                                    </a>
                                                                )}
                                                                {can.sns?.ig && can.sns.ig !== "#" && (
                                                                    <a href={can.sns.ig} target="_blank" className="sns-btn ig w-8 h-8 lg:w-10 lg:h-10 rounded-full border border-gray-100 dark:border-slate-700 shadow-sm flex items-center justify-center">
                                                                        <i data-lucide="instagram" className="w-4 h-4 lg:w-5 lg:h-5"></i>
                                                                    </a>
                                                                )}
                                                                {can.sns?.yt && can.sns.yt !== "#" && (
                                                                    <a href={can.sns.yt} target="_blank" className="sns-btn youtube w-8 h-8 lg:w-10 lg:h-10 rounded-full border border-gray-100 dark:border-slate-700 shadow-sm flex items-center justify-center">
                                                                        <i data-lucide="youtube" className="w-4 h-4 lg:w-5 lg:h-5"></i>
                                                                    </a>
                                                                )}
                                                            </div>
                                                            {can.decl && can.decl !== "#" && (
                                                                <a href={can.decl} target="_blank" className="flex items-center justify-center gap-2 px-4 py-2 lg:px-6 lg:py-3 nrp-bg-orange text-white rounded-2xl text-xs lg:text-sm font-black shadow-lg shadow-orange-200 hover:-translate-y-0.5 transition-all active:scale-95">
                                                                    <i data-lucide="file-text" className="w-3 h-3 lg:w-4 lg:h-4"></i>
                                                                    ì¶œë§ˆì„ ì–¸ ë³´ê¸°
                                                                </a>
                                                            )}
                                                        </div>
                                                    </div>
                                                    <div className="pt-6 border-t border-gray-100 dark:border-slate-800">
                                                        <ul className="space-y-2.5">
                                                            {can.bio.map((b, bIdx) => (
                                                                <li key={bIdx} className="text-[12px] lg:text-[13px] text-gray-600 dark:text-slate-400 flex items-start gap-2.5 font-semibold leading-relaxed">
                                                                    <span className="mt-2 flex-shrink-0 w-1.5 h-1.5 bg-orange-500 rounded-full"></span>
                                                                    <span dangerouslySetInnerHTML={{ __html: b }}></span>
                                                                </li>
                                                            ))}
                                                        </ul>
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                ) : <div className="h-full flex flex-col items-center justify-center opacity-30 text-center p-10"><p className="font-bold dark:text-slate-300">í•´ë‹¹ ì„ ê±°êµ¬ì— ë“±ë¡ëœ<br/>ì„œìš¸íŠ¹ë³„ì‹œ ê¸°ì´ˆì˜íšŒ í›„ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p></div>
                            ) : <div className="h-full flex flex-col items-center justify-center opacity-30 text-center p-10"><p className="font-bold dark:text-slate-300">ì„œìš¸ ì§€ë„ì˜ í–‰ì •ë™ì„ í´ë¦­í•˜ì—¬<br/>ì„ ê±°êµ¬ë³„ í›„ë³´ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p></div>}
                        </div>
                    </div>
                </div>
            );
        };

        const GyeonggiMapDashboard = () => {
            const [geoData, setGeoData] = useState(null);
            const [muniGeoData, setMuniGeoData] = useState(null);
            const [loading, setLoading] = useState(true);
            const [activeDistrict, setActiveDistrict] = useState(null); 
            const [selectedDistrict, setSelectedDistrict] = useState(null);
            const [selectedCandidateIdx, setSelectedCandidateIdx] = useState(0);
            const [mapBounds, setMapBounds] = useState({ minX: 126.3, maxX: 127.8, minY: 36.8, maxY: 38.3 });
            const [searchTerm, setSearchTerm] = useState('');
            const [showSuggestions, setShowSuggestions] = useState(false);
            const [zoomMultiplier, setZoomMultiplier] = useState(1.0);
            const [panOffset, setPanOffset] = useState({ x: 120, y: 90 });
            const [isDragging, setIsDragging] = useState(false);
            const [dragStart, setDragStart] = useState({ x: 0, y: 0 });
            const svgRef = useRef(null);

            const allDongsList = useMemo(() => {
                const list = [];
                Object.entries(GYEONGGI_INITIAL_DISTRICTS).forEach(([distName, info]) => {
                    info.dongs.forEach(dong => { list.push({ dong, district: distName }); });
                });
                return list;
            }, []);

            useEffect(() => {
                const fetchMapData = async () => {
                    try {
                        const DONG_URL = "https://raw.githubusercontent.com/vuski/admdongkor/master/ver20250401/HangJeongDong_ver20250401.geojson";
                        const MUNI_URL = "https://raw.githubusercontent.com/southkorea/southkorea-maps/master/kostat/2013/json/skorea_municipalities_geo.json";
                        const [resDong, resMuni] = await Promise.all([fetch(DONG_URL), fetch(MUNI_URL)]);
                        const dataDong = await resDong.json();
                        const dataMuni = await resMuni.json();
                        const dongFeatures = dataDong.features.filter(f => String(f.properties.adm_cd2 || f.properties.adm_cd || f.properties.ADM_CD || f.properties.code || "").startsWith('41'));
                        const muniFeatures = dataMuni.features.filter(f => {
                            const code = String(f.properties.code || f.properties.SIG_CD || f.properties.sig_cd || f.properties.ADM_CD || "");
                            return code.startsWith('41') || code.startsWith('31');
                        });
                        let minX = 180, maxX = 0, minY = 90, maxY = 0;
                        dongFeatures.forEach(f => {
                            const polygons = f.geometry.type === "Polygon" ? [f.geometry.coordinates] : f.geometry.coordinates;
                            polygons.forEach(poly => (Array.isArray(poly[0][0]) ? poly : [poly]).forEach(ring => ring.forEach(c => {
                                if (c[0] < minX) minX = c[0]; if (c[0] > maxX) maxX = c[0];
                                if (c[1] < minY) minY = 36.8; if (c[1] > maxY) maxY = c[1];
                            })));
                        });
                        setMapBounds({ minX, maxX, minY, maxY });
                        setGeoData({ ...dataDong, features: dongFeatures });
                        setMuniGeoData({ ...dataMuni, features: muniFeatures });
                    } catch (err) { setLoading(false); } finally { setLoading(false); }
                };
                fetchMapData();
            }, []);

            useEffect(() => {
                if (!loading && typeof lucide !== 'undefined') lucide.createIcons();
            }, [loading, selectedDistrict, activeDistrict]);

            const project = (coords) => {
                const { minX, maxX, minY, maxY } = mapBounds;
                const centerX = (minX + maxX) / 2;
                const centerY = (minY + maxY) / 2;
                const cosLat = Math.cos(centerY * Math.PI / 180);
                const scale = Math.min(800 / ((maxX - minX) * cosLat), 600 / (maxY - minY)) * 1.8 * zoomMultiplier;
                return [(coords[0] - centerX) * cosLat * scale + 400 + panOffset.x, 140 - (coords[1] - centerY) * scale + panOffset.y];
            };

            const generatePath = (f) => {
                if (!f || !f.geometry) return "";
                const { type, coordinates } = f.geometry;
                if (type === "Polygon") return coordinates.map(ring => "M" + ring.map(c => project(c).join(",")).join("L") + "Z").join(" ");
                if (type === "MultiPolygon") return coordinates.map(poly => poly.map(ring => "M" + ring.map(c => project(c).join(",")).join("L") + "Z").join(" ")).join(" ");
                return "";
            };

            const getDistrictNameFromFeature = (f) => {
                const fullAddr = normalizeFunc(f.properties.adm_nm || f.properties.ADM_NM || "");
                for (const [distName, info] of Object.entries(GYEONGGI_INITIAL_DISTRICTS)) {
                    const cityPartMatch = distName.match(/^[ê°€-í£]+[ì‹œêµ°]/);
                    if (!cityPartMatch) continue;
                    const cityPart = normalizeFunc(cityPartMatch[0]);
                    if (fullAddr.includes(cityPart)) {
                        if (info.dongs.some(d => {
                            const target = normalizeFunc(d);
                            return fullAddr.includes(target) || target.includes(fullAddr.slice(-target.length));
                        })) return distName;
                    }
                }
                return null;
            };

            const getDistColor = (dName) => {
                if (!dName) return document.documentElement.classList.contains('dark') ? "#020617" : "#fcf9f6";
                const hasCandidate = candidates.some(c => 
                    c.category === "ê¸°ì´ˆì˜ì›" && 
                    c.metropolitan === "ê²½ê¸°ë„" && 
                    dName.startsWith(c.region.replace('ê²½ê¸° ', '')) && 
                    dName.includes(c.district)
                );
                
                const city = dName.split(' ')[0] || "";
                const distLetter = dName.split(' ')[1] || "";
                const cityIdx = CITY_ORDER.indexOf(city);
                const letterIdx = "ê°€ë‚˜ë‹¤ë¼ë§ˆë°”ì‚¬ì•„ìì°¨ì¹´íƒ€íŒŒí•˜".indexOf(distLetter[0]);
                const colorIdx = (cityIdx + letterIdx) % 4;

                if (hasCandidate) return ACTIVE_ORANGE_PALETTE[colorIdx];
                const isDark = document.documentElement.classList.contains('dark');
                const palette = isDark ? EMPTY_GRAY_PALETTE_DARK : EMPTY_GRAY_PALETTE;
                return palette[colorIdx % palette.length];
            };

            const matchedCandidatesMap = useMemo(() => {
                if (!selectedDistrict) return [];
                const [selCity] = selectedDistrict.split(' ');
                return candidates.filter(can => {
                    if (can.category !== "ê¸°ì´ˆì˜ì›" || can.metropolitan !== "ê²½ê¸°ë„") return false;
                    const candidateCity = can.region.split(' ').pop();
                    const isCorrectCity = candidateCity === selCity;
                    const isCorrectDistrict = selectedDistrict.includes(can.district);
                    return isCorrectCity && isCorrectDistrict;
                });
            }, [selectedDistrict]);

            const onPointerDown = (e) => { setIsDragging(true); setDragStart({ x: e.clientX || (e.touches && e.touches[0].clientX), y: e.clientY || (e.touches && e.touches[0].clientY) }); };
            const onPointerMove = (e) => {
                if (!isDragging) return;
                const currentX = e.clientX || (e.touches && e.touches[0].clientX);
                const currentY = e.clientY || (e.touches && e.touches[0].clientY);
                setPanOffset(prev => ({ x: prev.x + (currentX - dragStart.x), y: prev.y + (currentY - dragStart.y) }));
                setDragStart({ x: currentX, y: currentY });
            };

            return (
                <div className="flex flex-col bg-[#fffbf7] dark:bg-slate-950 rounded-[2rem] border border-orange-100 dark:border-slate-800 overflow-hidden shadow-xl">
                    <main className="flex flex-col lg:flex-row p-4 sm:p-6 gap-4 sm:gap-6 h-[950px] lg:h-[600px]">
                        <div className={`relative h-[380px] lg:h-auto lg:flex-[1.5] bg-white dark:bg-slate-900 rounded-3xl border border-orange-50 dark:border-slate-800 overflow-hidden flex items-center justify-center ${isDragging ? 'cursor-grabbing' : 'cursor-grab'} shrink-0`}>
                            {loading ? <div className="animate-spin-custom w-10 h-10 border-4 border-orange-200 border-t-orange-500 rounded-full"></div> : (
                                <svg ref={svgRef} viewBox="0 0 800 600" className="w-full h-full drop-shadow-lg touch-none" onMouseDown={onPointerDown} onMouseMove={onPointerMove} onMouseUp={() => setIsDragging(false)} onMouseLeave={() => setIsDragging(false)} onTouchStart={onPointerDown} onTouchMove={onPointerMove} onTouchEnd={() => setIsDragging(false)}>
                                    {geoData.features.map((f, i) => {
                                        const dName = getDistrictNameFromFeature(f);
                                        const isSelected = selectedDistrict === dName;
                                        const baseFill = getDistColor(dName);
                                        return <path key={i} d={generatePath(f)} fill={isSelected ? "#9a3412" : baseFill} fillOpacity={selectedDistrict && !isSelected ? 0.2 : (activeDistrict === dName ? 0.8 : 1)} stroke={isSelected ? "#000" : (document.documentElement.classList.contains('dark') ? "#0f172a" : "#fff")} strokeWidth={isSelected ? "1" : "0.05"} className="map-path" onMouseEnter={() => !isDragging && dName && setActiveDistrict(dName)} onMouseLeave={() => setActiveDistrict(null)} onClick={() => dName && setSelectedDistrict(prev => prev === dName ? null : dName)} />;
                                    })}
                                    {muniGeoData.features.map((f, i) => <path key={i} d={generatePath(f)} fill="none" stroke={document.documentElement.classList.contains('dark') ? "#475569" : "#000"} strokeWidth="0.9" style={{ pointerEvents: 'none', opacity: selectedDistrict ? 0.1 : 1 }} />)}
                                </svg>
                            )}
                            <div className="absolute top-4 left-4 w-64 z-10">
                                <div className="bg-white/95 dark:bg-slate-800/95 backdrop-blur p-3 rounded-2xl border border-orange-50 dark:border-slate-700 flex items-center gap-2 shadow-lg">
                                    <i data-lucide="search" className="w-4 h-4 text-orange-400"></i>
                                    <input type="text" placeholder="ìë©´ë™ ê²€ìƒ‰ (ì˜ˆ: ì¸ì°½ë™)" className="bg-transparent outline-none w-full text-xs font-bold dark:text-slate-200" value={searchTerm} onChange={(e) => { setSearchTerm(e.target.value); setShowSuggestions(true); }} />
                                </div>
                                {showSuggestions && searchTerm.length > 0 && (
                                    <div className="mt-2 bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-h-40 overflow-y-auto custom-scrollbar border border-orange-50 dark:border-slate-700">
                                        {allDongsList.filter(it => normalizeFunc(it.dong).includes(normalizeFunc(searchTerm))).map((it, idx) => (
                                            <div key={idx} className="px-4 py-2 hover:bg-orange-50 dark:hover:bg-slate-700 cursor-pointer text-xs font-bold border-b border-orange-50 dark:border-slate-700 dark:text-slate-200" onClick={() => { setSelectedDistrict(it.district); setShowSuggestions(false); setSearchTerm(''); }}>{it.dong} ({it.district})</div>
                                        ))}
                                    </div>
                                )}
                            </div>
                            <div className="absolute bottom-4 right-4 flex flex-col gap-2">
                                <button onClick={() => setZoomMultiplier(p => p * 1.2)} className="w-10 h-10 bg-white dark:bg-slate-800 rounded-xl shadow border border-orange-50 dark:border-slate-700 text-orange-500 hover:bg-orange-500 hover:text-white transition-colors"><i data-lucide="plus" className="w-5 h-5 mx-auto"></i></button>
                                <button onClick={() => setZoomMultiplier(p => p / 1.2)} className="w-10 h-10 bg-white dark:bg-slate-800 rounded-xl shadow border border-orange-50 dark:border-slate-700 text-slate-400 dark:text-slate-500 hover:bg-slate-500 hover:text-white transition-colors"><i data-lucide="minus" className="w-5 h-5 mx-auto"></i></button>
                                <button onClick={() => { setZoomMultiplier(1); setPanOffset({x:120, y:90}); }} className="w-10 h-10 bg-white dark:bg-slate-800 rounded-xl shadow border border-orange-100 dark:border-slate-700 transition-colors"><i data-lucide="refresh-cw" className="w-4 h-4 mx-auto text-slate-400 dark:text-slate-500"></i></button>
                            </div>
                        </div>
                        <div className="flex-1 bg-white dark:bg-slate-900 rounded-3xl border border-orange-50 dark:border-slate-800 shadow-xl flex flex-col overflow-hidden">
                            <div className={`p-5 sm:p-6 transition-colors duration-500 ${selectedDistrict ? 'bg-orange-500 text-white' : 'bg-orange-50 dark:bg-slate-800 text-orange-200 dark:text-slate-600'}`}>
                                <div className="flex justify-between items-start">
                                    <div className="flex-1 overflow-hidden">
                                        <h2 className="text-xl font-black truncate dark:text-white">{selectedDistrict || "ì§€ì—­ì„ ì„ íƒí•˜ì„¸ìš”"}</h2>
                                        {selectedDistrict && <div className="mt-2 text-[10px] font-bold opacity-80 leading-tight">{GYEONGGI_INITIAL_DISTRICTS[selectedDistrict].dongs.join(', ')}</div>}
                                    </div>
                                    {selectedDistrict && (
                                        <div className="ml-4 bg-[#1e293b] px-3 py-1.5 rounded-xl border border-white/10 text-center shrink-0 shadow-lg">
                                            <p className="text-[10px] font-black text-slate-200 leading-none mb-2">ì„ ê±°ì •ìˆ˜</p>
                                            <p className="text-lg font-black text-white leading-none">{GYEONGGI_INITIAL_DISTRICTS[selectedDistrict].seats}ëª…</p>
                                        </div>
                                    )}
                                </div>
                            </div>
                            <div className="flex-1 p-5 sm:p-6 lg:overflow-y-auto custom-scrollbar">
                                {selectedDistrict ? (
                                    matchedCandidatesMap.length > 0 ? <IntegratedProfile can={matchedCandidatesMap[selectedCandidateIdx]} /> :
                                    <div className="h-full flex flex-col items-center justify-center text-slate-300 dark:text-slate-600 opacity-50"><i data-lucide="users" className="w-12 h-12 mb-2"></i><p>ë“±ë¡ëœ í›„ë³´ìê°€ ì—†ìŠµë‹ˆë‹¤.</p></div>
                                ) : <div className="h-full flex flex-col items-center justify-center text-orange-200 dark:text-slate-700 opacity-50"><i data-lucide="mouse-pointer-2" className="w-12 h-12 mb-2"></i><p>ì§€ë„ë¥¼ í´ë¦­í•´ì£¼ì„¸ìš”!</p></div>}
                            </div>
                        </div>
                    </main>
                </div>
            );
        };

        const seoulRoot = ReactDOM.createRoot(document.getElementById('map-dashboard-root'));
        seoulRoot.render(<MapDashboard />);

        const gyeonggiRoot = ReactDOM.createRoot(document.getElementById('gyeonggi-map-dashboard-root-render'));
        gyeonggiRoot.render(<GyeonggiMapDashboard />);
    </script>
</body>
</html>

